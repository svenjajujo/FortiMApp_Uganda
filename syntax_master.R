#install packages

#if(!require(installr))
#install.packages("installr");
#require(installr)
#updateR()

#update.packages(ask = FALSE)

packages <- c("openxlsx", "plyr", "readr", "dplyr", "hablar", "janitor", "tidyverse", "ggplot2", "readxl")
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
invisible(lapply(packages, library, character.only = TRUE))

#Set working directory
#setwd("C:/Users/sjungjohann/OneDrive - Global Alliance for Improved Nutrition/Data for analysis/R syntax/GAIN-R-dev")
setwd("/home/developer/projects/Uganda/Uganda")

## set exact dataset name of xlsx only
fortiMappDatasetFileName = "Uganda_data-set-13-04-2023.xlsx"

## SECTION select, format and clean raw data

#Select and open dataset, ensure all blank are actually blank, remove any "-"
FortiMApp <- read_excel(fortiMappDatasetFileName, na = "-")

#Convert data types #Fixes analysis_date in raw data or import
FortiMApp_cleantype <- FortiMApp #%>%
#  convert(dte(report_date,production_date,best_by_date, analysis_date), chr(report_ID, product_ID, sample, lab_sample_code, measurand, lab_code, lab_result_ID,food, country, region, city, town, market_place, store_type,supervisior_group_name, outlet_name,brand_name,product_description,food_type, origin,package_container, selected_supplier_by_supplier_name,selected_supplier_country,lab_method_name,measurand, element_name),fct(fortifcation_logo,is_original,qualitative_result),lgl(Reference,report_status,brand_detail_status,report_detail_status,product_status,brand_volume_status,	package_status,sample_status,lab_sample_status,result_status,Active,Incomplete))
#, num(longitude,latitude,price,stock_volume,package_amount,Nutrient_Count, sample_quantity,sample_cost,quantitative_result_Mg_Kg, mu, natural_content_mg_kg,standard_min, standard_max,product_volume_amount,product_volume_percentage))
#FortiMApp_cleantype <- FortiMApp_cleantype %>% num(longitude,latitude,price,stock_volume,package_amount,Nutrient_Count, sample_quantity,sample_cost,quantitative_result_Mg_Kg, mu, natural_content_mg_kg,standard_min, standard_max,product_volume_amount,product_volume_percentage)

#clean "price" variable by removing 0 and 1
FortiMApp_cleantype$price <- ifelse(FortiMApp_cleantype$price %in% c(0, 1), "", FortiMApp_cleantype$price)

#clean "quantitative_result_Mg_Kg" variable by setting results_status to TRUE where values are to be excluded
FortiMApp_cleantype$result_status <- ifelse((FortiMApp_cleantype$measurand == "Vitamin A" & FortiMApp_cleantype$quantitative_result_Mg_Kg > 200), "TRUE", FortiMApp_cleantype$result_status)

#Filter to only select data for specific country and (timepoint) supervisor group: NAFDAC/GAIN 2019
FortiMAppFilter_cleantype <- FortiMApp_cleantype %>%
  #dplyr::filter(country=="NIGERIA" & supervisior_group_name=="NAFDAC/GAIN 2019") %>%
  #dplyr::filter(country=="NIGERIA" & (supervisior_group_name=="NAFDAC/GAIN 2019"|supervisior_group_name=="IPSOS 2021")) %>%
  #Filter or select active cases 
  #dplyr::filter(report_status==FALSE&brand_detail_status==FALSE&report_detail_status==FALSE) %>%
  #Select variables from main dataframe by removing the below variables
  #subset(select=-c(food_ID,country_ID,region_ID,city_ID,market_place,store_type_ID,supervisior_group_ID,supervisior_group_name,user_name,user_ID,user_email,brand_name_ID,brand_name,product_description,food_type_ID,product_image_url,container_image_url,Supplier_image,fortifcation_logo_image,fortifcation_statement_image,storage_condition,storage_comments,average_product_min,average_product_max,Product_average_content_mg_kg_pos_or_blank,Product_average_content_mg_kg_neg,MU_Max,Lab_Sample_Average_mg_kg_pos_or_blank,Lab_sample_average_content_mg_kg_neg,avg_pro_lab_sample_max,Sample_Average_mg_kg_pos_or_blank,Sample_average_content_mg_kg_neg,avg_pro_sample_max,natural_content_mg_kg,fortification_status_by_measurand,product_fortification_status,product_label_status,imported_exported_by_supplier_ref,imported_exported_by_supplier_deleted,imported_exported_by_company_group_name,imported_exported_by_company_group_description,ackaged_by_company_group_description,packaged_by_supplier_deleted,packaged_by_company_group_name,packaged_by_supplier_ref,produced_by_company_group_name,produced_by_company_group_description,produced_by_supplier_deleted,produced_by_supplier_ref,selected_supplier_by_company_group_description,selected_supplier_by_company_group_description,distributed_by_company_group_name,distributed_by_company_group_description,distributed_by_supplier_deleted,distributed_by_supplier_ref,selected_supplier_deleted,produced_by_supplier_address,packaged_by_supplier_address,imported_exported_by_supplier_address,distributed_by_supplier_address,Nutrient_Amount_count,Nutrient_Unit_count,Nutrient_Compound_count,Nutrient_element_count,sample_quantity,sample_cost,element_ID,lab_method_id,result,result_unit,report_status,brand_detail_status,report_detail_status,result_status,Active,supplier_volume_amount,supplier_volume_percentage,product_status,package_status,brand_volume_status,Incomplete,sample_status, lab_sample_status))
  subset(select=c(report_ID, product_ID, price, food,country,region, town, longitude, latitude, city, store_type,supervisior_group_name,user_name,brand_name,product_description,food_type,origin, package_container, package_amount, package_unit,selected_supplier_by_company_group_name, selected_supplier_by_supplier_name, selected_supplier_by_supplier_address, selected_supplier_country,product_volume_percentage, product_volume_amount,supplier_volume_amount,supplier_volume_percentage, fortifcation_logo, fortifcation_statement, Nutrient_Count,sample, sample_cost, production_date, best_by_date, lab_sample_code, measurand, lab_code, qualitative_result, quantitative_result_Mg_Kg, element_name, lab_name, lab_result_ID,mu, standard_min, standard_max, report_status,	brand_detail_status,	report_detail_status,	product_status,	brand_volume_status,	package_status,	sample_status,	lab_sample_status,	result_status,	Active,	Incomplete))


#generated a new CATEGORY VARIABLE called "BrandProduct"
FortiMAppFilter_cleantype$BrandProduct <- paste(FortiMAppFilter_cleantype$brand_name, FortiMAppFilter_cleantype$product_description, sep = " - ")
FortiMAppFilter_cleantype$BrandProduct <- as.factor(FortiMAppFilter_cleantype$BrandProduct)

#generated a new CATEGORY VARIABLE called "Packaging"
FortiMAppFilter_cleantype$Packaging <- paste(FortiMAppFilter_cleantype$package_container, FortiMAppFilter_cleantype$package_amount, FortiMAppFilter_cleantype$package_unit, sep = " ")
FortiMAppFilter_cleantype$Packaging <- as.factor(FortiMAppFilter_cleantype$Packaging)

#generated a new CATEGORY VARIABLE called "Packaging_unit_kg_l"
FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::mutate(Packaging_unit_kg_l = ifelse(package_unit == "kg",
                                             package_amount,
                                             ifelse(package_unit == "L",
                                                    package_amount,
                                                    ifelse(package_unit == "cl",
                                                           package_amount / 100,
                                                           ifelse(package_unit == "dl",
                                                                  package_amount / 10 ,
                                                                  ifelse(package_unit == "g",
                                                                         package_amount / 1000,
                                                                         ifelse(package_unit == "mg",
                                                                                package_amount / 1000000,
                                                                                ifelse(package_unit == "ml",
                                                                                       package_amount * 1000,
                                                                                       NA))))))))


#generated new "Packaging_price_kg_l" by multiplying "price" with "Packaging_unit_kg_l" 
FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::mutate(Packaging_price_kg_l = (as.numeric(price) / as.numeric(Packaging_unit_kg_l)))

#cleaning "Packaging_price_kg_l_clean" from outliers (wrong entry) by removing values that are 3 std from mean/median of the "Packaging_price_kg_l" where "BrandProduct" or product_ID and "Packaging" is the same

FortiMAppFilter_cleantypeprice <- FortiMAppFilter_cleantype %>%
  dplyr::select(report_ID, food, BrandProduct,Packaging,Packaging_price_kg_l)
FortiMAppFilter_cleantypeprice <- distinct(FortiMAppFilter_cleantypeprice)

FortiMAppFilter_cleantypeprice$z_score <- ave(FortiMAppFilter_cleantypeprice$Packaging_price_kg_l, FortiMAppFilter_cleantypeprice$BrandProduct, FUN=scale)

FortiMAppFilter_cleantypeprice <- FortiMAppFilter_cleantypeprice %>%
     dplyr::mutate(Packaging_price_kg_l_clean = ifelse((z_score > -2 & z_score < 2) | is.na(z_score), FortiMAppFilter_cleantypeprice$Packaging_price_kg_l,"NA"))

FortiMAppFilter_cleantypeprice$z_score_food <- ave(as.numeric(FortiMAppFilter_cleantypeprice$Packaging_price_kg_l_clean), FortiMAppFilter_cleantypeprice$food, FUN=scale)

# FortiMAppFilter_cleantypeprice <- FortiMAppFilter_cleantypeprice %>%
#   dplyr::mutate(FortiMAppFilter_cleantypeprice$Packaging_price_kg_l_clean = ifelse((FortiMAppFilter_cleantypeprice$z_score_food > -2 & FortiMAppFilter_cleantypeprice$z_score_food < 2) | is.na(FortiMAppFilter_cleantypeprice$z_score_food), FortiMAppFilter_cleantypeprice$Packaging_price_kg_l_clean,"NA"))

FortiMAppFilter_cleantypeprice$Packaging_price_kg_l_clean <- ifelse((FortiMAppFilter_cleantypeprice$z_score_food > -2 & FortiMAppFilter_cleantypeprice$z_score_food < 2) | is.na(FortiMAppFilter_cleantypeprice$z_score_food), FortiMAppFilter_cleantypeprice$Packaging_price_kg_l_clean,"NA")

  
FortiMAppFilter_cleantype <-  dplyr::left_join(FortiMAppFilter_cleantype,FortiMAppFilter_cleantypeprice,by =c("report_ID", "food","BrandProduct","Packaging", "Packaging_price_kg_l")) 
  
 write.xlsx(FortiMAppFilter_cleantypeprice, file = "FortiMAppFilter_cleantypeprice.xlsx",
            sheetName = "test", append = FALSE)



#generated new "product_avg_price_kg_l" by calculating the mean of the  "Packaging_price_kg_l" where "BrandProduct" or product_ID is the same
FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  #dplyr::mutate(product_avg_price_kg_l = mean(as.numeric(Packaging_price_kg_l), na.rm = TRUE), product_min_price_kg_l = min(as.numeric(Packaging_price_kg_l), na.rm = TRUE), product_max_price_kg_l = max(as.numeric(Packaging_price_kg_l), na.rm = TRUE))
  dplyr::mutate(product_avg_price_kg_l = mean(as.numeric(Packaging_price_kg_l_clean), na.rm = TRUE), product_min_price_kg_l = min(as.numeric(Packaging_price_kg_l_clean), na.rm = TRUE), product_max_price_kg_l = max(as.numeric(Packaging_price_kg_l_clean), na.rm = TRUE))

#generate new CATEGORY VARIABLE called "zone7" and "zone6"
# 
# FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
#   dplyr::mutate(zone7 = ifelse(region == "Benue"| region == "Federal Capital Territory"| region == "Kwara"| region == "Plateau",
#                                "North Central",
#                                ifelse(region == "Adamawa"| region == "Bauchi"| region == "Borno"| region == "Gombe",
#                                       "North East",
#                                       ifelse(region == "Kaduna"| region == "Kano"| region == "Sokoto",
#                                              "North West",
#                                              ifelse(region == "Abia"| region == "Anambra"| region == "Enugu"| region == "Imo",
#                                                     "South East",
#                                                     ifelse(region == "Cross River"| region == "Delta"| region == "Rivers",
#                                                            "South South",
#                                                            ifelse(region == "Ogun"| region == "Oshogbo"| region == "Osun"| region == "Oyo",
#                                                                   "South West",
#                                                                   ifelse(region == "Lagos",
#                                                                          "Lagos",
#                                                                          NA))))))))
# 
# FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
#   dplyr::mutate(zone6 = ifelse(region == "Benue"| region == "Federal Capital Territory"| region == "Kwara"| region == "Plateau",
#                                "North Central",
#                                ifelse(region == "Adamawa"| region == "Bauchi"| region == "Borno"| region == "Gombe",
#                                       "North East",
#                                       ifelse(region == "Kaduna"| region == "Kano"| region == "Sokoto",
#                                              "North West",
#                                              ifelse(region == "Abia"| region == "Anambra"| region == "Enugu"| region == "Imo",
#                                                     "South East",
#                                                     ifelse(region == "Cross River"| region == "Delta"| region == "Rivers",
#                                                            "South South",
#                                                            ifelse(region == "Lagos"| region == "Ogun"| region == "Oshogbo"| region == "Osun"| region == "Oyo",
#                                                                   "South West",
#                                                                   NA)))))))

#generate Large producers and others. This requires the supplier_volume_amount variable to contain data for at least the main suppliers.

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::mutate(supplier_large = ifelse(food == "Oil" & supplier_volume_amount >= 15000, TRUE,
                                        ifelse(food == "Margarine" & supplier_volume_amount >= 15000, TRUE,
                                               ifelse(food == "Salt" & supplier_volume_amount >= 30000, TRUE,
                                                      ifelse(food == "Wheat flour" & supplier_volume_amount >= 45000, TRUE, 
                                                             ifelse(food == "Maize flour" & supplier_volume_amount >= 45000, TRUE,
                                                                    ifelse(food == "Sugar" & supplier_volume_amount >= 75000, TRUE,
                                                                           NA)))))))
FortiMAppFilter_cleantype$supplier_large <- ifelse(is.na(FortiMAppFilter_cleantype$supplier_large),FALSE, FortiMAppFilter_cleantype$supplier_large)



FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::mutate(origin_large = ifelse(origin == "Local" & supplier_large == TRUE, "Local large",
                                      ifelse(origin == "Local" & supplier_large == FALSE, "Local other",
                                             ifelse(origin == "Imported" & supplier_large == TRUE, "Import large",
                                                    ifelse(origin == "Imported" & supplier_large == FALSE, "Import other",
                                                           NA)))))


#generate new prerequisite variable "package_fortification_logo", "package_fortification_statement", "package_fortification_labelling"
FortiMAppFilter_cleantype <- dplyr::mutate(FortiMAppFilter_cleantype, package_fortification_logo = ifelse(fortifcation_logo == 'No fortification logo', FALSE , TRUE))
FortiMAppFilter_cleantype <- dplyr::mutate(FortiMAppFilter_cleantype, package_fortification_statement = ifelse(is.na(fortifcation_statement), FALSE, TRUE))
FortiMAppFilter_cleantype <- dplyr::mutate(FortiMAppFilter_cleantype, package_fortification_nutrient = ifelse(Nutrient_Count>0, TRUE, FALSE))
FortiMAppFilter_cleantype <- dplyr::mutate(FortiMAppFilter_cleantype, package_fortification_labelling = ifelse(package_fortification_statement == TRUE | package_fortification_logo == TRUE, TRUE, FALSE))
FortiMAppFilter_cleantype <- dplyr::mutate(FortiMAppFilter_cleantype, package_fortification_labelnutrient = ifelse(package_fortification_statement == TRUE | package_fortification_logo == TRUE | package_fortification_nutrient == TRUE, TRUE, FALSE))

#generate new CATEGORY VARIABLES for product fortification labelling elements: "product_fortification_logo", "product_fortification_statement", "product_fortification_nutrient"

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::mutate(product_fortification_logo = ifelse(any(package_fortification_logo == TRUE),TRUE,FALSE))

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::mutate(product_fortification_statement = ifelse(any(package_fortification_statement == TRUE),TRUE,FALSE))

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::mutate(product_fortification_nutrient = ifelse(any(package_fortification_nutrient == TRUE),TRUE,FALSE))

#generate new CATEGORY VARIABLES for general product fortification labelling status (2 or 3 labelling elements): "product_fortification_labelling" (logo, statement) and "product_fortification_labelnutrient" (logo, statement, nutrient)

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::mutate(product_fortification_labelling = ifelse(any(package_fortification_labelling == TRUE),TRUE, FALSE))
  #dplyr::mutate(product_fortification_labelling = ifelse(any(package_fortification_labelling == TRUE),product_fortification_labelnutrient=="Fortification logo or statement", product_fortification_labelnutrient=="No fortification labelling"))
  FortiMAppFilter_cleantype$product_fortification_labelling <- ifelse(FortiMAppFilter_cleantype$product_fortification_labelling==TRUE,"Fortification logo or statement", "No fortification labelling")

FortiMAppFilter_cleantype <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::mutate(product_fortification_labelnutrient = ifelse(any(package_fortification_labelnutrient == TRUE),TRUE,FALSE))
  #dplyr::mutate(FortiMAppFilter_cleantype$product_fortification_labelnutrient = ifelse(any(package_fortification_labelnutrient == TRUE),FortiMAppFilter_cleantype$product_fortification_labelnutrient=="Fortification logo, statement or nutrient",FortiMAppFilter_cleantype$product_fortification_labelnutrient=="No fortification labelling"))
  FortiMAppFilter_cleantype$product_fortification_labelnutrient <- ifelse(FortiMAppFilter_cleantype$product_fortification_labelnutrient==TRUE,"Fortification logo, statement or nutrient label", "No fortification labelling")

  
  write.xlsx(FortiMAppFilter_cleantype, file = "FortiMAppFilter_cleantype.xlsx",
             sheetName = "datasubset_cleantype", append = FALSE)
  
#MAKE LINK TO MARKET MODEL HERE TO PROVIDE WEIGHTS ACROSS ALL PRODUCTS
#Generate volume weight VARIABLE national volume weight distributed to regional availability in shops. Calculation: total product volume ("ProductvolAmountAvg")/total count of unique reports/shops by product ("ProdReport_count") = avg product volume per shop ("ShopVolAvg"), corrected to 1 if product count of product was below 1 ("ShopVolAvgCorrected")
Datasubset_ProductAvailVolWeight <- FortiMAppFilter_cleantype %>%
  dplyr::group_by(BrandProduct) %>%
  dplyr::summarise(ProdReport_count = n_distinct(report_ID),  ProductvolAmountAvg = mean(product_volume_amount))%>%
  dplyr::mutate(ShopVolAvg = round((ProductvolAmountAvg/ProdReport_count),digits =3))%>%
  dplyr::mutate(ShopVolAvgCorrected = ifelse (ShopVolAvg < 1, 1, ShopVolAvg))%>%
  dplyr::mutate(ProdVolCorrectedTotal = ShopVolAvgCorrected*ProdReport_count)

FortiMAppFilter_cleantype_weight <- dplyr::left_join(FortiMAppFilter_cleantype,Datasubset_ProductAvailVolWeight,by = 'BrandProduct')


#generate new CATEGORY VARIABLES for product fortification status calculated from lab sample results: “product_avg_pos_or_blank”, “product_avg_min_pos_or_blank”, “product_avg_max_pos_or_blank” and “product_avg_neg”, “product_avg_min_neg”, “product_avg_max_neg”

FortiMAppFilter_cleantype_weight <- FortiMAppFilter_cleantype_weight %>%
  # remove all the values from “quantitative_result_Mg_Kg” and “mu” where result is inactivated (result_status = TRUE) and generating new variable “result_ppm” and “result_mu”
  #dplyr::mutate(result_ppm = ifelse(result_status == TRUE, NA , quantitative_result_Mg_Kg), result_mu = ifelse(result_status == TRUE, NA , mu))
  dplyr::mutate(result_ppm = ifelse(result_status == TRUE|is.na(quantitative_result_Mg_Kg), NA , quantitative_result_Mg_Kg), result_mu = ifelse(result_status == TRUE|is.na(mu), NA , mu))

#filter only observations with quantitative or qualitative results
Datasubset_FortiMAppFilter_FortStatus<-FortiMAppFilter_cleantype_weight %>%
  dplyr::filter(!is.na(result_ppm)|!is.na(qualitative_result)) %>%
#generate  “result_ppm_min” “result_ppm_max” by calculating “result_ppm” minus (“mu”/100*“result_ppm”) and respectively “result_ppm” plus (“mu”/100*“result_ppm”)  
#mutate only where result value is available meaning where result_status equals to TRUE 
   dplyr::mutate(result_ppm_min = ifelse(result_status == TRUE, NA ,(result_ppm -(result_mu/100*result_ppm))),result_ppm_max = ifelse(result_status == TRUE, NA ,(result_ppm+(result_mu/100*result_ppm))))

## generate is_sample_negative variable for results (to generate a filter variable to filter records where sample is negative meaning any qualitative_result record is equal to "Negative" related to that sample) 
#dplyr::group_by (sample) summarize and then left join by sample

Datasubset_FortiMAppFilter_FortStatusSample<-Datasubset_FortiMAppFilter_FortStatus %>%
  #group by sample
  dplyr::group_by(sample) %>% dplyr::summarise(is_sample_negative = case_when(any(qualitative_result == "Negative")~ "TRUE", TRUE ~ "FALSE"))

  Datasubset_FortiMAppFilter_FortStatus <- dplyr::left_join(Datasubset_FortiMAppFilter_FortStatus,Datasubset_FortiMAppFilter_FortStatusSample,by = 'sample')

Datasubset_FortiMAppFilter_FortStatusNeg <- Datasubset_FortiMAppFilter_FortStatus %>%
    dplyr::filter(is_sample_negative=="TRUE" | is_sample_negative==TRUE)
## filter by is_sample_negative == FALSE meaning where all “qualitative_result” is “Positive” or blank
Datasubset_FortiMAppFilter_FortStatus <- Datasubset_FortiMAppFilter_FortStatus %>%
    dplyr::filter(is_sample_negative=="FALSE" | is_sample_negative==FALSE)

#by first generating “lab_lab_sample_avg_pos_or_blank”, “lab_lab_sample_avg_min_pos_or_blank”, “lab_lab_sample_avg_max_pos_or_blank” by taking the average of all lab sample results (“result_ppm”, “result_ppm_min”, “result_ppm_max”) where “food”, “BrandProduct”, “measurand”, “sample”, “lab_sample_code”, “lab_name” are the same 
Datasubset_FortiMAppFilter_FortStatus<-Datasubset_FortiMAppFilter_FortStatus %>%
  #group by measurand, lab and lab sample code
  dplyr::group_by(food,BrandProduct, sample, lab_sample_code, lab_name, measurand) %>%
  # generate variable to distingush samples with atleast qualitative result equal to negative and samples with no negative qualitative result
  #only consider results of lab_sample_codes that have no negative qualitative result
  #generate filter VARIABLES for pos_blank qualitative results to remove negative labsamples to calculate averages for pos_or_blank results only
  #dplyr::mutate(sample_fort_neg = ifelse(any(qualitative_result == "Negative"), FALSE, TRUE))%>% 
  dplyr::filter(!isTRUE(result_status)&!is.na(result_ppm)) %>%
  #dplyr::filter(isFALSE(sample_fort_neg)) %>%
  #generate "labresult_count" and count the number of lab sample results that were averaged for the respective measurand, lab and lab sample code
  #dplyr::mutate(labresult_count_pos_or_blank = ifelse(isTRUE(labsample_fort_pos_or_blank), n_distinct(lab_result_ID), NA))%>% 
  dplyr::mutate(labresult_count_pos_or_blank = n_distinct(lab_result_ID))%>%
  #calculate "labsample_lab_avg_min","labsample_lab_avg_max","labsample_lab_avg","labsample_labMU_avg", "labsample_labMU_max"
  dplyr::mutate(labsample_lab_avg_min_pos_or_blank = mean(result_ppm_min),labsample_lab_avg_max_pos_or_blank = mean(result_ppm_max), labsample_lab_avg_pos_or_blank = mean(result_ppm),labsample_lab_MU_avg_pos_or_blank = mean(result_mu), labsample_lab_MU_max_pos_or_blank = max(result_mu, na.rm = TRUE))

#second generating “lab_sample_avg_pos_or_blank”, “lab_sample_avg_min_pos_or_blank”, “lab_sample_avg_max_pos_or_blank”: by taking the average of all lab sample results (“lab_lab_sample_avg_content_pos_or_blank”, “lab_lab_sample_avg_min_content_pos_or_blank”, “lab_lab_sample_avg_max_content_pos_or_blank” or respectively “lab_lab_sample_avg_content_neg”, “lab_lab_sample_avg_min_content_neg”, “lab_lab_sample_avg_max_content_neg”) where “food”, “BrandProduct”, “measurand”, “sample”, “lab_sample_code” are the same and where all “qualitative_result” is not “Negative”(“Positive” or blank)
Datasubset_FortiMAppFilter_FortStatus <- Datasubset_FortiMAppFilter_FortStatus %>%
  dplyr::group_by(BrandProduct, measurand, sample, lab_sample_code) %>%
  dplyr::mutate(labsample_avg_min_pos_or_blank = mean(labsample_lab_avg_min_pos_or_blank), labsample_avg_max_pos_or_blank = mean(labsample_lab_avg_max_pos_or_blank), labsample_avg_pos_or_blank = mean(labsample_lab_avg_pos_or_blank), labsample_MU_avg_pos_or_blank = mean(labsample_lab_MU_avg_pos_or_blank), labsample_MU_max_pos_or_blank = max(labsample_lab_MU_max_pos_or_blank))

#third generating “sample_avg_pos_or_blank”, “sample_avg_min_pos_or_blank”, “sample_avg_max_pos_or_blank” and “sample_avg_neg”, “sample_avg_min_neg”, “sample_avg_max_neg”: by taking the average of all sample results (“lab_sample_avg_pos_or_blank”, “lab_sample_avg_min_pos_or_blank”, “lab_sample_avg_max_pos_or_blank” or respectively “lab_lab_sample_avg_neg”, “lab_lab_sample_avg_min_neg”, “lab_lab_sample_avg_max_neg”) where “food”, “BrandProduct”, “measurand”, “sample” are the same and where all “qualitative_result” is not “Negative”(“Positive” or blank) or respectively where any “qualitative_result” is “Negative”
Datasubset_FortiMAppFilter_FortStatus <- Datasubset_FortiMAppFilter_FortStatus %>%
  dplyr::group_by(BrandProduct, measurand, sample) %>%
  # count distinct lab samples that have no negative qualitative result  
  dplyr::mutate(labsample_count_pos_or_blank = n_distinct(lab_sample_code))%>%
  dplyr::mutate(sample_avg_min_pos_or_blank = mean(labsample_avg_min_pos_or_blank), sample_avg_max_pos_or_blank = mean(labsample_avg_max_pos_or_blank), sample_avg_pos_or_blank = mean(labsample_avg_pos_or_blank),sample_MU_avg_pos_or_blank = mean(labsample_MU_avg_pos_or_blank), sample_MU_max_pos_or_blank = max(labsample_MU_max_pos_or_blank))

#fourth generating “product_avg_pos_or_blank”, “product_avg_min_pos_or_blank”, “product_avg_max_pos_or_blank” and “product_avg_neg”: by taking the average of all sample results (“sample_avg_content_pos_or_blank”, “sample_avg_min_pos_or_blank”, “sample_avg_max_pos_or_blank” where “food”, “BrandProduct”, “measurand” are the same and where all “qualitative_result” is not “Negative”(“Positive” or blank)
Datasubset_FortiMAppFilter_FortStatus <- Datasubset_FortiMAppFilter_FortStatus %>%
  dplyr::group_by(BrandProduct, measurand) %>%
  # count distinct samples that have no negative qualitative result
  dplyr::mutate(sample_count = n_distinct(sample))%>%
  dplyr::mutate(product_avg_min_pos_or_blank = mean(sample_avg_min_pos_or_blank), product_avg_max_pos_or_blank = mean(sample_avg_max_pos_or_blank), product_avg_pos_or_blank = mean(sample_avg_pos_or_blank),product_MU_avg_pos_or_blank = mean(sample_MU_avg_pos_or_blank), product_MU_max_pos_or_blank = max(sample_MU_max_pos_or_blank))

#negative qualitative test averages

#by first generating “lab_lab_sample_avg_neg”, “lab_lab_sample_avg_min_neg”, “lab_lab_sample_avg_max_neg” by taking the average of all lab sample results (“result_ppm”, “result_ppm_min”, “result_ppm_max”) where “food”, “BrandProduct”, “measurand”, “sample”, “lab_sample_code”, “lab_name” are the same 
Datasubset_FortiMAppFilter_FortStatusNeg<-Datasubset_FortiMAppFilter_FortStatusNeg %>%
  #group by measurand, lab and lab sample code
  dplyr::group_by(food,BrandProduct, sample, lab_sample_code, lab_name, measurand) %>%
  dplyr::filter(!isTRUE(result_status)&!is.na(result_ppm)) %>%
  dplyr::mutate(labresult_count_neg = n_distinct(lab_result_ID))%>%
  #calculate "labsample_lab_avg_min","labsample_lab_avg_max","labsample_lab_avg","labsample_labMU_avg", "labsample_labMU_max"
  dplyr::mutate(labsample_lab_avg_min_neg = mean(result_ppm_min),labsample_lab_avg_max_neg = mean(result_ppm_max), labsample_lab_avg_neg = mean(result_ppm),labsample_lab_MU_avg_neg = mean(result_mu), labsample_lab_MU_max_neg = max(result_mu, na.rm = TRUE))

#second generating “lab_sample_avg_neg”, “lab_sample_avg_min_neg”, “lab_sample_avg_max_neg”: by taking the average of all lab sample results (“lab_lab_sample_avg_content_neg”, “lab_lab_sample_avg_min_content_neg”, “lab_lab_sample_avg_max_content_neg” or respectively “lab_lab_sample_avg_content_neg”, “lab_lab_sample_avg_min_content_neg”, “lab_lab_sample_avg_max_content_neg”) where “food”, “BrandProduct”, “measurand”, “sample”, “lab_sample_code” are the same and where all “qualitative_result” is “Negative”
Datasubset_FortiMAppFilter_FortStatusNeg <- Datasubset_FortiMAppFilter_FortStatusNeg %>%
  dplyr::group_by(BrandProduct, measurand, sample, lab_sample_code) %>%
  dplyr::mutate(labsample_avg_min_neg = mean(labsample_lab_avg_min_neg), labsample_avg_max_neg = mean(labsample_lab_avg_max_neg), labsample_avg_neg = mean(labsample_lab_avg_neg), labsample_MU_avg_neg = mean(labsample_lab_MU_avg_neg), labsample_MU_max_neg = max(labsample_lab_MU_max_neg))

#third generating “sample_avg_neg”, “sample_avg_min_neg”, “sample_avg_max_neg” and “sample_avg_neg”, “sample_avg_min_neg”, “sample_avg_max_neg”: by taking the average of all sample results (“lab_sample_avg_neg”, “lab_sample_avg_min_neg”, “lab_sample_avg_max_neg” or respectively “lab_lab_sample_avg_neg”, “lab_lab_sample_avg_min_neg”, “lab_lab_sample_avg_max_neg”) where “food”, “BrandProduct”, “measurand”, “sample” are the same and where all “qualitative_result” is  “Negative” or respectively where any “qualitative_result” is “Negative”
Datasubset_FortiMAppFilter_FortStatusNeg <- Datasubset_FortiMAppFilter_FortStatusNeg %>%
  dplyr::group_by(BrandProduct, measurand, sample) %>%
  # count distinct lab samples that have negative qualitative result  
  dplyr::mutate(labsample_count_neg = n_distinct(lab_sample_code))%>%
  dplyr::mutate(sample_avg_min_neg = mean(labsample_avg_min_neg), sample_avg_max_neg = mean(labsample_avg_max_neg), sample_avg_neg = mean(labsample_avg_neg),sample_MU_avg_neg = mean(labsample_MU_avg_neg), sample_MU_max_neg = max(labsample_MU_max_neg))

#fourth generating “product_avg_neg”, “product_avg_min_neg”, “product_avg_max_neg” and “product_avg_neg”: by taking the average of all sample results (“sample_avg_content_neg”, “sample_avg_min_neg”, “sample_avg_max_neg” where “food”, “BrandProduct”, “measurand” are the same and where all “qualitative_result” is  “Negative”
Datasubset_FortiMAppFilter_FortStatusNeg <- Datasubset_FortiMAppFilter_FortStatusNeg %>%
  dplyr::group_by(BrandProduct, measurand) %>%
  # count distinct samples that have negative qualitative result
  dplyr::mutate(sample_count = n_distinct(sample))%>%
  dplyr::mutate(product_avg_min_neg = mean(sample_avg_min_neg), product_avg_max_neg = mean(sample_avg_neg), product_avg_neg = mean(sample_avg_neg),product_MU_avg_neg = mean(sample_MU_avg_neg), product_MU_max_neg = max(sample_MU_max_neg))

Datasubset_FortiMAppFilter_FortStatus <- dplyr::full_join(Datasubset_FortiMAppFilter_FortStatus,Datasubset_FortiMAppFilter_FortStatusNeg)

write.xlsx(Datasubset_FortiMAppFilter_FortStatus, file = "Datasubset_FortiMAppFilter_FortStatus.xlsx",
           sheetName = "Fort", append = FALSE)

#generate new variable "product_fortification_status_new"
#Product Fortification Status Calculation
#Define product fortification status category for each distinct product ID.
#If measurand fortification status count is nil, then product fortification status is NA.
#If measurand fortification status count is 1, then product fortification status is same as measurand fortification status.
#If any measurand fortification status is “not fortified” and other measurand fortification status is any other than “not fortified”, then product fortification status is “partially fortified”
#If any measurand fortification status is “Fortified below standard minimum” and other measurand fortification status is other than “not fortified” or “Fortified below standard minimum” then product fortification status is “Fortified below standard minimum”
#If any measurand fortification status is “Fortified in standard range” and other measurand fortification status is other than “not fortified” or “Fortified below standard minimum” or “Fortified in standard range”, then product fortification status is “Fortified above standard range”. Meaning if one or more are "Fortified in standard range" and the others are "fortified above standard maximum", then product fortification Status is "Fortified above standard maximum"


Datasubset_FortiMAppFilter_FortStatus2 <- Datasubset_FortiMAppFilter_FortStatus %>%
  dplyr::group_by(BrandProduct, measurand) %>%
  dplyr::mutate(Fortification_status_measurand = case_when( product_avg_pos_or_blank!= 0 & product_avg_max_pos_or_blank<standard_min ~ "Fortified below standard min",
                                                            product_avg_pos_or_blank!= 0 & if_else(standard_max == "NA", TRUE, (product_avg_min_pos_or_blank<standard_max)) ~ "Fortified within standard range",
                                                            product_avg_pos_or_blank!= 0 & product_avg_max_pos_or_blank>standard_min ~ "Fortified within standard range",
                                                            product_avg_pos_or_blank!= 0 & product_avg_min_pos_or_blank>standard_max ~ "Fortified above standard max",
                                                            product_avg_pos_or_blank== 0  ~ "Not fortified")) 

#dplyr::mutate(Fort_status_Notfortified_Avgmin= mean(product_avg_min_pos_or_blank),Fort_status_BelowStd_Avgmin=mean(product_avg_min_pos_or_blank), Fort_status_InStdRange_Avgmin=mean(product_avg_min_pos_or_blank), Fort_status_AboveStd_Avgmin=mean(product_avg_min_pos_or_blank),Fort_status_Notfortified_Avgmax= mean(product_avg_max_pos_or_blank),Fort_status_BelowStd_Avgmax=mean(product_avg_max_pos_or_blank), Fort_status_InStdRange_Avgmax=mean(product_avg_max_pos_or_blank), Fort_status_AboveStd_Avgmax=mean(product_avg_max_pos_or_blank),Fort_status_Notfortified_Avg= mean(product_avg_pos_or_blank),Fort_status_BelowStd_Avg=mean(product_avg_pos_or_blank), Fort_status_InStdRange_Avg=mean(product_avg_pos_or_blank), Fort_status_AboveStd_Avg=mean(product_avg_pos_or_blank))

#remove duplicates
Datasubset_FortiMAppFilter_FortStatus2 <- distinct(Datasubset_FortiMAppFilter_FortStatus2)

write.xlsx(Datasubset_FortiMAppFilter_FortStatus2, file = "Datasubset_FortiMAppFilter_FortStatus2.xlsx",
           sheetName = "Fort_Measurand", append = FALSE)

#generate average content variables by micronutrient/measurand to be able to bring them all from a product by measurand level to the product level view
Datasubset_FortiMAppFilter_FortStatus2Avg <- Datasubset_FortiMAppFilter_FortStatus2  %>%
  dplyr::select(BrandProduct, measurand, Fortification_status_measurand, product_avg_min_pos_or_blank, product_avg_max_pos_or_blank,	product_avg_pos_or_blank,	product_MU_avg_pos_or_blank,	product_MU_max_pos_or_blank, standard_min, standard_max)%>%
  dplyr::group_by(BrandProduct,measurand) %>%
  dplyr::mutate(VitA_standard_min= ifelse(measurand=="Vitamin A", standard_min, NA),VitA_standard_max= ifelse(measurand=="Vitamin A", standard_max, NA), VitA_product_avg_min_pos_or_blank= ifelse(measurand=="Vitamin A", product_avg_min_pos_or_blank, NA), VitA_product_avg_max_pos_or_blank= ifelse(measurand=="Vitamin A",	product_avg_max_pos_or_blank,	NA), VitA_product_avg_pos_or_blank= ifelse(measurand=="Vitamin A", product_avg_pos_or_blank, NA), VitA_product_MU_avg_pos_or_blank= ifelse(measurand=="Vitamin A",product_MU_avg_pos_or_blank, NA),	VitA_product_MU_max_pos_or_blank= ifelse(measurand=="Vitamin A", product_MU_max_pos_or_blank, NA),Iron_standard_min= ifelse(measurand=="Iron", standard_min, NA), Iron_standard_max= ifelse(measurand=="Iron",	standard_max,	NA), Iron_product_avg_min_pos_or_blank= ifelse(measurand=="Iron", product_avg_min_pos_or_blank, NA), Iron_product_avg_max_pos_or_blank= ifelse(measurand=="Iron",	product_avg_max_pos_or_blank,	NA), Iron_product_avg_pos_or_blank= ifelse(measurand=="Iron", product_avg_pos_or_blank, NA), Iron_product_MU_avg_pos_or_blank= ifelse(measurand=="Iron",product_MU_avg_pos_or_blank, NA),	Iron_product_MU_max_pos_or_blank= ifelse(measurand=="Iron", product_MU_max_pos_or_blank, NA),Zinc_standard_min= ifelse(measurand=="Zinc", standard_min, NA), Zinc_standard_max= ifelse(measurand=="Zinc",	standard_max,	NA),Zinc_product_avg_min_pos_or_blank= ifelse(measurand=="Zinc", product_avg_min_pos_or_blank, NA), Zinc_product_avg_max_pos_or_blank= ifelse(measurand=="Zinc",	product_avg_max_pos_or_blank,	NA), Zinc_product_avg_pos_or_blank= ifelse(measurand=="Zinc", product_avg_pos_or_blank, NA), Zinc_product_MU_avg_pos_or_blank= ifelse(measurand=="Zinc",product_MU_avg_pos_or_blank, NA),	Zinc_product_MU_max_pos_or_blank= ifelse(measurand=="Zinc", product_MU_max_pos_or_blank, NA),Iodine_standard_min= ifelse(measurand=="Iodine", standard_min, NA), Iodine_standard_max= ifelse(measurand=="Iodine",	standard_max,	NA),Iodine_product_avg_min_pos_or_blank= ifelse(measurand=="Iodine", product_avg_min_pos_or_blank, NA), Iodine_product_avg_max_pos_or_blank= ifelse(measurand=="Iodine",	product_avg_max_pos_or_blank,	NA), Iodine_product_avg_pos_or_blank= ifelse(measurand=="Iodine", product_avg_pos_or_blank, NA), Iodine_product_MU_avg_pos_or_blank= ifelse(measurand=="Iodine",product_MU_avg_pos_or_blank, NA),	Iodine_product_MU_max_pos_or_blank= ifelse(measurand=="Iodine", product_MU_max_pos_or_blank, NA))
#dplyr::summarise(VitA_product_avg_min_pos_or_blank= ifelse(measurand=="Vitamin A", product_avg_min_pos_or_blank, NA), VitA_product_avg_max_pos_or_blank= ifelse(measurand=="Vitamin A",	product_avg_max_pos_or_blank,	NA), VitA_product_avg_pos_or_blank= ifelse(measurand=="Vitamin A", product_avg_pos_or_blank, NA), VitA_product_MU_avg_pos_or_blank= ifelse(measurand=="Vitamin A",product_MU_avg_pos_or_blank, NA),	VitA_product_MU_max_pos_or_blank= ifelse(measurand=="Vitamin A", product_MU_max_pos_or_blank, NA), Iron_product_avg_min_pos_or_blank= ifelse(measurand=="Iron", product_avg_min_pos_or_blank, NA), Iron_product_avg_max_pos_or_blank= ifelse(measurand=="Iron",	product_avg_max_pos_or_blank,	NA), Iron_product_avg_pos_or_blank= ifelse(measurand=="Iron", product_avg_pos_or_blank, NA), Iron_product_MU_avg_pos_or_blank= ifelse(measurand=="Iron",product_MU_avg_pos_or_blank, NA),	Iron_product_MU_max_pos_or_blank= ifelse(measurand=="Iron", product_MU_max_pos_or_blank, NA),Zinc_product_avg_min_pos_or_blank= ifelse(measurand=="Zinc", product_avg_min_pos_or_blank, NA), Zinc_product_avg_max_pos_or_blank= ifelse(measurand=="Zinc",	product_avg_max_pos_or_blank,	NA), Zinc_product_avg_pos_or_blank= ifelse(measurand=="Zinc", product_avg_pos_or_blank, NA), Zinc_product_MU_avg_pos_or_blank= ifelse(measurand=="Zinc",product_MU_avg_pos_or_blank, NA),	Zinc_product_MU_max_pos_or_blank= ifelse(measurand=="Zinc", product_MU_max_pos_or_blank, NA),Iodine_product_avg_min_pos_or_blank= ifelse(measurand=="Iodine", product_avg_min_pos_or_blank, NA), Iodine_product_avg_max_pos_or_blank= ifelse(measurand=="Iodine",	product_avg_max_pos_or_blank,	NA), Iodine_product_avg_pos_or_blank= ifelse(measurand=="Iodine", product_avg_pos_or_blank, NA), Iodine_product_MU_avg_pos_or_blank= ifelse(measurand=="Iodine",product_MU_avg_pos_or_blank, NA),	Iodine_product_MU_max_pos_or_blank= ifelse(measurand=="Iodine", product_MU_max_pos_or_blank, NA))

#generate the fortification status variable
Datasubset_FortiMAppFilter_FortStatus2Avg <- Datasubset_FortiMAppFilter_FortStatus2Avg %>%
  dplyr::mutate(Fort_status_Notfortified= ifelse(Fortification_status_measurand=="Not fortified", 1, 0),Fort_status_BelowStd=ifelse(Fortification_status_measurand=="Fortified below standard min", 1, 0),Fort_status_InStdRange=ifelse(Fortification_status_measurand=="Fortified within standard range", 1, 0),Fort_status_AboveStd=ifelse(Fortification_status_measurand=="Fortified above standard max", 1, 0))%>%
  dplyr::select(BrandProduct, measurand, Fortification_status_measurand, Fort_status_Notfortified, Fort_status_BelowStd, Fort_status_InStdRange, Fort_status_AboveStd, VitA_standard_min, VitA_standard_max, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min, Iron_standard_max, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min, Zinc_standard_max, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min, Iodine_standard_max ,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)

#generate "Product fortification status" VARIABLE  at BrandProduct level

temp <- ddply(Datasubset_FortiMAppFilter_FortStatus2Avg, ~BrandProduct, summarize, Fort_status_Notfortified= sum(Fort_status_Notfortified),Fort_status_BelowStd=sum(Fort_status_BelowStd), Fort_status_InStdRange=sum(Fort_status_InStdRange), Fort_status_AboveStd=sum(Fort_status_AboveStd))

temp$product_fortification_status<- ifelse(
  temp$Fort_status_Notfortified >0 & temp$Fort_status_BelowStd<1 & temp$Fort_status_InStdRange<1 & temp$Fort_status_AboveStd<1, "Not fortified",ifelse(
    temp$Fort_status_Notfortified<1 & temp$Fort_status_BelowStd>0 & temp$Fort_status_InStdRange<1 & temp$Fort_status_AboveStd<1, "Fortified below standard min",ifelse(
      temp$Fort_status_Notfortified<1 & temp$Fort_status_BelowStd<1 & temp$Fort_status_InStdRange>0 & temp$Fort_status_AboveStd<1, "Fortified within standard range",ifelse(
        temp$Fort_status_Notfortified<1 & temp$Fort_status_BelowStd<1 & temp$Fort_status_InStdRange<1 & temp$Fort_status_AboveStd>0, "Fortified above standard max",ifelse(
          temp$Fort_status_Notfortified>0 & (temp$Fort_status_BelowStd>0 | temp$Fort_status_InStdRange>0 |temp$Fort_status_AboveStd>0), "Partially fortified",ifelse(
            temp$Fort_status_Notfortified<1 & temp$Fort_status_BelowStd>0 & (temp$Fort_status_InStdRange>0 | temp$Fort_status_AboveStd>0), "Fortified below standard min",ifelse(
              temp$Fort_status_Notfortified<1 & temp$Fort_status_BelowStd<1 & (temp$Fort_status_InStdRange>0 | temp$Fort_status_AboveStd>0), "Fortified above standard min","Not analyzed"
            )
          )
        )
      )
    )
  )
)

#generate new variable "product_fortification_status_new2":
#Define product fortification status category where product ID/ BrandProduct is the same:
#If "product_fortification_status_new" is “Fortified in standard range” or "Fortified above standard maximum" then "product_fortification_status_new2" is “Fortified above standard minimum”, otherwise "product_fortification_status_new2" is same as "product_fortification_status_new"

temp$product_fortification_status2 <-ifelse(temp$product_fortification_status== 'Not fortified', "Not fortified",ifelse(temp$product_fortification_status== 'Fortified below standard min'| temp$product_fortification_status== 'Partially fortified', "Fortified below standard min", ifelse(temp$product_fortification_status== 'Fortified within standard range'| temp$product_fortification_status== 'Fortified above standard maximum', "Fortified above standard min","Not analyzed")))

#generate new variable "product_fortification_status_new3":
#Define product fortification status category where product ID/ BrandProduct is the same:
#If "product_fortification_status_new" is “Fortified below standard minimum” or “Fortified in standard range”, "partially fortified", or "Fortified above standard maximum" then "product_fortification_status_new3" is “Fortified to any extent”, otherwise "product_fortification_status_new3" is same as "product_fortification_status_new"

temp$product_fortification_status3 <-ifelse(temp$product_fortification_status== 'Not fortified', "Not fortified",ifelse(temp$product_fortification_status== 'Fortified below standard min'| temp$product_fortification_status== 'Partially fortified'| temp$product_fortification_status== 'Fortified within standard range'| temp$product_fortification_status== 'Fortified above standard maximum', "Fortified to any extent","Not analyzed"))

#generate new variable "product_fortification_status_new4":
#Define product fortification status category where product ID/ BrandProduct is the same:
#If "product_fortification_status_new" is “Fortified below standard minimum” or “Fortified in standard range” or "Fortified above standard maximum" then "product_fortification_status_new4" is “Fortified to any extent”, If "product_fortification_status_new" is "partially fortified" then product_fortification_status_new4" is "not fortified" then otherwise "product_fortification_status_new4" is same as "product_fortification_status_new"

temp$product_fortification_status4 <-ifelse((temp$product_fortification_status== 'Not fortified' |temp$product_fortification_status== 'Partially fortified'), "Not fortified",ifelse(temp$product_fortification_status== 'Fortified below standard min'| temp$product_fortification_status== 'Fortified within standard range'| temp$product_fortification_status== 'Fortified above standard maximum', "Fortified to any extent", "Not analyzed"))

temp <- temp %>%
  dplyr::select(BrandProduct, product_fortification_status, product_fortification_status2, product_fortification_status3, product_fortification_status4)



#bring all measurand results to the brandproduct level
Datasubset_FortiMAppFilter_FortStatus2Avg <- Datasubset_FortiMAppFilter_FortStatus2Avg %>%
  dplyr::select(BrandProduct, VitA_standard_min, VitA_standard_max , VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min, Iron_standard_max , Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min, Zinc_standard_max, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min, Iodine_standard_max, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>%
  dplyr::group_by(BrandProduct)%>%
  dplyr::summarise(VitA_standard_min_avg=mean(VitA_standard_min,na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max,na.rm = TRUE),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank,na.rm = TRUE),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank,na.rm = TRUE),Iron_standard_min_avg=mean(Iron_standard_min,na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max,na.rm = TRUE), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank, na.rm = TRUE), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_pos_or_blank, na.rm = TRUE), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank, na.rm = TRUE),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank, na.rm = TRUE),Zinc_standard_min_avg=mean(Zinc_standard_min,na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max,na.rm = TRUE), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank, na.rm = TRUE), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank, na.rm = TRUE), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank,na.rm = TRUE),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank,na.rm = TRUE),Iodine_standard_min_avg=mean(Iodine_standard_min,na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank,na.rm = TRUE),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank,na.rm = TRUE))

Datasubset_FortiMAppFilter_FortStatus23Avg <- dplyr::left_join(Datasubset_FortiMAppFilter_FortStatus2Avg,temp,by =c("BrandProduct"))

FortiMAppFilter_cleantype_weightFort2Avg <- dplyr::left_join(FortiMAppFilter_cleantype_weight,Datasubset_FortiMAppFilter_FortStatus23Avg,by =c("BrandProduct"))

FortiMAppFilter_cleantype_weightFort2Avg <- distinct(FortiMAppFilter_cleantype_weightFort2Avg)
FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status <- ifelse(is.na(FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status),"Not analyzed", FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status)
FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status2 <- ifelse(is.na(FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status2),"Not analyzed", FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status2)
FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status3 <- ifelse(is.na(FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status3),"Not analyzed", FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status3)
FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status4 <- ifelse(is.na(FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status4),"Not analyzed", FortiMAppFilter_cleantype_weightFort2Avg$product_fortification_status4)


#write.xlsx(FortiMAppFilter_cleantype_weightFort2, file = "FortiMAppFilter_cleantype_weightFort2.xlsx", sheetName = "Fort_Measurand", append = FALSE)
write.xlsx(FortiMAppFilter_cleantype_weightFort2Avg, file = "FortiMAppFilter_cleantype_weightFort2Avg.xlsx", sheetName = "Fort_MeasurandAvg", append = FALSE)


#generate datasubset with main variables
datasubset <-  FortiMAppFilter_cleantype_weightFort2Avg%>%
  dplyr::select(food, food_type, origin, origin_large, price, package_amount, package_unit,Packaging_unit_kg_l, Packaging_price_kg_l, product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, selected_supplier_by_supplier_name, selected_supplier_country, BrandProduct, report_ID, ShopVolAvgCorrected, store_type, region, standard_min, standard_max, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,	product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4,VitA_standard_min_avg, VitA_standard_max_avg , VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)
#remove duplicates
datasubset <-  distinct(datasubset)

write.xlsx(datasubset, file = "datasubset.xlsx",
           sheetName = "datasubset", append = FALSE)


#SECTION: GENERATE other specific DATASUBSETS and OUTPUT TABLES for reports
#Availability


#generate table with min, max avg product price   ## TODO if somewhere else then remove this one
Report_product_price <- datasubset %>%
  dplyr::group_by(food,food_type,BrandProduct)%>%
  dplyr::summarise(ProductCount = n_distinct(BrandProduct),product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE))

write.xlsx(Report_product_price, file = "Report_product_price.xlsx",
           sheetName = "Product_price", append = FALSE)



#Tables by FOOD and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET LEVEL 1: to generate Reportsum and ProductVolume and ProductCount by food and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
Datasubset_ReportsumProdVolByFoodProduct <- datasubset %>%
  #dplyr::group_by(food,origin, food_type,BrandProduct, ShopVolAvgCorrected,ProdVolCorrectedTotal, product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3)%>% 
  dplyr::group_by(food,origin, origin_large, food_type,BrandProduct, product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, ShopVolAvgCorrected,product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg , VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg , Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
  dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)

write.xlsx(Datasubset_ReportsumProdVolByFoodProduct, file = "Datasubset_ReportsumProdVolByFoodProduct.xlsx",
           sheetName = "Product", append = FALSE)


#Reportsum and ProductVolume by food

#ShopCount by food
ShopCount_Food <- datasubset %>%
  dplyr::group_by(food)%>%
  dplyr::summarise(ReportCount = n_distinct(report_ID))

write.xlsx(ShopCount_Food, file = "ShopCount_Food.xlsx",
           sheetName = "ShopFood", append = FALSE)

ReportsumProdVolByFood <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
     VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
     Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
     Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
     Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
     product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
     VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
     Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
     Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
     Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
     product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
     VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
     Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
     Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
     Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
     product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
     VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
     Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
     Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
     Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
     product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
     VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
     Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
     Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
     Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
   )%>%
  dplyr::mutate(ProdVolPercentFood= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFood = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFood = round(ReportCount2 / sum(ReportCount2)*100, 3))

ReportsumProdVolByFood <- left_join(ReportsumProdVolByFood, ShopCount_Food,by =c("food"))

write.xlsx(ReportsumProdVolByFood, file = "ReportsumProdVol_Food.xlsx",
           sheetName = "Food", append = FALSE)


#Reportsum and ProductVolume by food and food type
#the ReportCount2 is a weight and cannot be used to extract unique retail shop count as it sums retail shops by product
#we want to use ProductVolumeShopSum and ReportCount2 as weights by product applied for price and micronutrient content
#ReportPercentType and ProdVolPercentType show proportions of group categories of products weighted by RportCount2 or ProductVolumeShopSum, respectively

ReportsumProdVolByFoodFoodtype <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, food_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentType= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFoodtype, file = "ReportsumProdVol_FoodType.xlsx",
           sheetName = "FoodType", append = FALSE)

#Reportsum and ProductVolume by food and origin
ReportsumProdVolByFoodOrigin <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOrigin = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOrigin = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOrigin = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOrigin, file = "ReportsumProdVol_FoodOrigin.xlsx",
           sheetName = "FoodOrigin", append = FALSE)


#Reportsum and ProductVolume by food and origin_large
ReportsumProdVolByFoodOriginlarge <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, origin_large)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginlarge = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlarge = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlarge = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVolByFoodOriginlarge, file = "ReportsumProdVol_FoodOriginlarge.xlsx",
           sheetName = "FoodOriginlarge", append = FALSE)

#Reportsum and ProductVolume by food and product fortification labelling (logo, statement)
ReportsumProdVolByFoodLabelling <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_labelling)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelling = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentLabelling = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentLabelling = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodLabelling, file = "ReportsumProdVol_FoodLabelling.xlsx",
           sheetName = "FoodLabelling", append = FALSE)

#Reportsum and ProductVolume by food and product fortification labelnutrient (logo, statement,  nutrient label)
ReportsumProdVolByFoodLabelnutrient <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_labelnutrient)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelnutrient = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentLabelnutrient = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentLabelnutrient = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodLabelnutrient, file = "ReportsumProdVol_FoodLabelnutrient.xlsx",
           sheetName = "FoodLabelnutrient", append = FALSE)

#Reportsum and ProductVolume by food and product fortification status
ReportsumProdVolByFoodFort <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_status)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort, file = "ReportsumProdVol_FoodFort.xlsx",
           sheetName = "FoodFort", append = FALSE)

#Reportsum and ProductVolume by food and product fortification status2
ReportsumProdVolByFoodFort2 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_status2)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort2, file = "ReportsumProdVol_FoodFort2.xlsx",
           sheetName = "FoodFort2", append = FALSE)

#Reportsum and ProductVolume by food and product fortification status3
ReportsumProdVolByFoodFort3 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_status3)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort3, file = "ReportsumProdVol_FoodFort3.xlsx",
           sheetName = "FoodFort3", append = FALSE)

#Reportsum and ProductVolume by food and product fortification status4
ReportsumProdVolByFoodFort4 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, product_fortification_status4)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort4, file = "ReportsumProdVol_FoodFort4.xlsx",
           sheetName = "FoodFort4", append = FALSE)


##Tables by FOOD, ORIGIN and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#Reportsum and ProductVolume by food, origin and food type
ReportsumProdVolByFoodOriginFoodtype <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, food_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginType= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginFoodtype, file = "ReportsumProdVol_OriginFoodtype.xlsx",
           sheetName = "OriginFoodtype", append = FALSE)


ReportsumProdVolByFoodOriginlargeFoodtype <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, origin_large, food_type)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>% 
  dplyr::mutate(ProdVolPercentOriginlargeType= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlargeType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlargeType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginlargeFoodtype, file = "ReportsumProdVol_OriginlargeFoodtype.xlsx",
           sheetName = "OriginlargeFoodtype", append = FALSE)

ReportsumProdVolByFoodFoodtypeOriginlarge <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, food_type, origin_large)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentTypeOriginlarge= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentTypeOriginlarge = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentTypeOriginlarge = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFoodtypeOriginlarge, file = "ReportsumProdVol_FoodtypeOriginlarge.xlsx",
           sheetName = "FoodtypeOriginlarge", append = FALSE)

#Reportsum and ProductVolume by food, origin, and product fortification labelling (logo, statement)
ReportsumProdVolByFoodOriginLabelling <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, product_fortification_labelling)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginLabel = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginLabel = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginLabel = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginLabelling, file = "ReportsumProdVol_FoodOriginLabelling.xlsx",
           sheetName = "FoodOriginLabel", append = FALSE)


#Reportsum and ProductVolume by food, originlarge, and product fortification labelling (logo, statement)
ReportsumProdVolByFoodOriginlargeLabelling <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, origin_large, product_fortification_labelling)%>%
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>% 
  dplyr::mutate(ProdVolPercentOriginlargeLabel = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlargeLabel = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlargeLabel = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVolByFoodOriginlargeLabelling, file = "ReportsumProdVol_FoodOriginlargeLabelling.xlsx",
           sheetName = "FoodOriginlargeLabel", append = FALSE)

#Reportsum and ProductVolume by food, origin and product fortification labelnutrient (logo, statement,  nutrient label)
ReportsumProdVolByFoodOriginLabelnutr <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, origin, product_fortification_labelnutrient)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginLabelnutr = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginLabelnutr = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginLabelnutr = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginLabelnutr, file = "ReportsumProdVol_FoodOriginLabelnutr.xlsx",
           sheetName = "FoodOriginLabelnutr", append = FALSE)


#Reportsum and ProductVolume by food, originlarge and product fortification labelnutrient (logo, statement,  nutrient label)
ReportsumProdVolByFoodOriginlargeLabelnutr <- Datasubset_ReportsumProdVolByFoodProduct %>% 
  dplyr::group_by(food, origin_large, product_fortification_labelnutrient)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginlargeLabelnutr = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlargeLabelnutr = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlargeLabelnutr = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVolByFoodOriginlargeLabelnutr, file = "ReportsumProdVol_FoodOriginlargeLabelnutr.xlsx",
           sheetName = "FoodOriginlargeLabelnutr", append = FALSE)

#Reportsum and ProductVolume by food, origin and product fortification status
ReportsumProdVolByFoodOriginFort <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, product_fortification_status)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginFort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginFort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginFort = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginFort, file = "ReportsumProdVol_FoodOriginFort.xlsx",
           sheetName = "FoodOriginFort", append = FALSE)

#Reportsum and ProductVolume by food, origin and product fortification status2
ReportsumProdVol_FoodOriginFort2 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, product_fortification_status2)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginFort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginFort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginFort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodOriginFort2, file = "ReportsumProdVol_FoodOriginFort2.xlsx",
           sheetName = "FoodOriginFort2", append = FALSE)

#Reportsum and ProductVolume by food, origin and product fortification status3
ReportsumProdVol_FoodOriginFort3 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, product_fortification_status3)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginFort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginFort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginFort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodOriginFort3, file = "ReportsumProdVol_FoodOriginFort3.xlsx",
           sheetName = "FoodOriginFort3", append = FALSE)

#Reportsum and ProductVolume by food, origin and product fortification status4
ReportsumProdVol_FoodOriginFort4 <- Datasubset_ReportsumProdVolByFoodProduct %>%
  dplyr::group_by(food, origin, product_fortification_status4)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginFort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginFort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginFort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodOriginFort4, file = "ReportsumProdVol_FoodOriginFort4.xlsx",
           sheetName = "FoodOriginFort4", append = FALSE)


#Tables by FOOD, STORE TYPE and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET LEVEL 2: to generate Reportsum and ProductVolume and ProductCount by food, store type and product (including subcategories: Origin, Foodtype, Label,FortStatus which is the same by product)
Datasubset_ReportsumProdVol_FoodStoretypeProduct <- datasubset %>%
  #dplyr::group_by(food,origin, food_type,BrandProduct, ShopVolAvgCorrected,ProdVolCorrectedTotal, product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3)%>% 
  dplyr::group_by(food,origin, origin_large, food_type,BrandProduct, product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, ShopVolAvgCorrected,product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, store_type)%>% 
  dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)

write.xlsx(Datasubset_ReportsumProdVol_FoodStoretypeProduct, file = "Datasubset_ReportsumProdVol_FoodStoretypeProduct.xlsx",
           sheetName = "ProductStoretype", append = FALSE) 


#ShopCount by food and Store type 
ShopCount_FoodStoretype <- datasubset %>%
  dplyr::group_by(food, store_type)%>%
  dplyr::summarise(ReportCount = n_distinct(report_ID))%>%
  dplyr::mutate(ShopPercentFoodStoretype = round(ReportCount / sum(ReportCount)*100, 2))

write.xlsx(ShopCount_FoodStoretype, file = "ShopCount_FoodStoretype.xlsx",
           sheetName = "ShopStoretype", append = FALSE)


#Reportsum and ProductVolume by food and Store type 
ReportsumProdVol_FoodStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3))

ReportsumProdVol_FoodStoretype <- left_join(ReportsumProdVol_FoodStoretype, ShopCount_FoodStoretype,by =c("food","store_type"))

write.xlsx(ReportsumProdVol_FoodStoretype, file = "ReportsumProdVol_FoodStoretype.xlsx",
           sheetName = "Storetype", append = FALSE)

                   
                   
#Reportsum and ProductVolume by food, food type and Store type 
ReportsumProdVol_FoodFoodtypeStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, food_type, store_type )%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentTypeStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentTypeStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentTypeStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodFoodtypeStoretype, file = "ReportsumProdVol_FoodTypeStoretype.xlsx",
           sheetName = "FoodTypeStoretype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and food type
ReportsumProdVol_FoodStoretypeFoodtype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type, food_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeFoodtype= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeFoodtype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeFoodtype = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodStoretypeFoodtype, file = "ReportsumProdVol_FoodStoretypeFoodtype.xlsx",
           sheetName = "StoretypeFoodtype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and origin
ReportsumProdVol_FoodStoretypeOrigin <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type, origin)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeOrigin = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeOrigin = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeOrigin = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodStoretypeOrigin, file = "ReportsumProdVol_FoodStoretypeOrigin.xlsx",
           sheetName = "FoodStoretypeOrigin", append = FALSE)

#Reportsum and ProductVolume by food, origin and Store type 
ReportsumProdVol_FoodOriginStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, origin, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodOriginStoretype, file = "ReportsumProdVol_FoodOriginStoretype.xlsx",
           sheetName = "FoodOriginStoretype", append = FALSE)


#Reportsum and ProductVolume by food, Store type and origin large
ReportsumProdVol_FoodStoretypeOriginlarge <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, store_type, origin_large)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>% 
  dplyr::mutate(ProductPercentStoretypeOriginlarge = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentStoretypeOriginlarge = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodStoretypeOriginlarge, file = "ReportsumProdVol_FoodStoretypeOriginlarge.xlsx",
           sheetName = "FoodStoretypeOriginlarge", append = FALSE)

#Reportsum and ProductVolume by food, originlarge and Store type 
ReportsumProdVol_FoodOriginlargeStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, origin_large, store_type)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginlargeStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlargeStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlargeStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodOriginlargeStoretype, file = "ReportsumProdVol_FoodOriginlargeStoretype.xlsx",
           sheetName = "FoodOriginlargeStoretype", append = FALSE)



#Filter only large
#Reportsum and ProductVolume by food, originlarge and Store type 
ReportsumProdVol_FoodStoretypeFilterOriginLarge <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::filter(origin_large =="Import large"|origin_large =="Local large")%>%
  dplyr::group_by(food, store_type)%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginlargeStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentOriginlargeStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentOriginlargeStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodStoretypeFilterOriginLarge, file = "FoodStoretypeFilterOriginLarge.xlsx",
           sheetName = "FoodStoretypeOriginlarge", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification labelnutrient
ReportsumProdVol_FoodStoretypeLabelnutrient <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type, product_fortification_labelnutrient)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeLabelnutr = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeLabelnutr = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeLabelnutr = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodStoretypeLabelnutrient, file = "ReportsumProdVol_FoodStoretypeLabelnutrient.xlsx",
           sheetName = "FoodStoretypeLabelnutr", append = FALSE)

#Reportsum and ProductVolume by food, product fortification labelnutrient and Store type
ReportsumProdVol_FoodLabelnutrientStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, product_fortification_labelnutrient, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelnutrStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentLabelnutrStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentLabelnutrStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodLabelnutrientStoretype, file = "ReportsumProdVol_FoodLabelnutrientStoretype.xlsx",
           sheetName = "FoodLabelnutrStoretype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification labelling
ReportsumProdVol_FoodStoretypeLabelling <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, store_type, product_fortification_labelling)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeLabel = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentStoretypeLabel = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentStoretypeLabel = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodStoretypeLabelling, file = "ReportsumProdVol_FoodStoretypeLabelling.xlsx",
           sheetName = "FoodStoretypeLabel", append = FALSE)

#Reportsum and ProductVolume by food, product fortification labelling and Store type
ReportsumProdVol_FoodLabellingStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, product_fortification_labelling, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentLabelStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentLabelStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodLabellingStoretype, file = "ReportsumProdVol_FoodLabellingStoretype.xlsx",
           sheetName = "FoodLabelStoretype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification status
ReportsumProdVol_FoodStoretypeFort <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, store_type, product_fortification_status)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeFort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentStoretypeFort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentStoretypeFort = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodStoretypeFort, file = "ReportsumProdVol_FoodStoretypeFort.xlsx",
           sheetName = "FoodStoretypeFort", append = FALSE)

#Reportsum and ProductVolume by food, product fortification status and Store type 
ReportsumProdVolByFoodFortStoretype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, product_fortification_status, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFortStoretype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentFortStoretype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentFortStoretype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVolByFoodFortStoretype, file = "ReportsumProdVol_FoodFortStoretype.xlsx",
           sheetName = "FoodFortStoretype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification status2
ReportsumProdVol_FoodStoretypeFort2 <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type, product_fortification_status2)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeFort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeFort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeFort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodStoretypeFort2, file = "ReportsumProdVol_FoodStoretypeFort2.xlsx",
           sheetName = "FoodStoretypeFort2", append = FALSE)

#Reportsum and ProductVolume by food, product fortification status2 and Store type 
ReportsumProdVol_FoodFort2Storetype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, product_fortification_status2, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort2Storetype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort2Storetype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort2Storetype = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodFort2Storetype, file = "ReportsumProdVol_FoodFort2Storetype.xlsx",
           sheetName = "FoodFort2Storetype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification status3
ReportsumProdVol_FoodStoretypeFort3 <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, store_type, product_fortification_status3)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeFort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeFort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeFort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodStoretypeFort3, file = "ReportsumProdVol_FoodStoretypeFort3.xlsx",
           sheetName = "FoodStoretypeFort3", append = FALSE)

#Reportsum and ProductVolume by food, product fortification status3 and Store type
ReportsumProdVol_FoodFort3Storetype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, product_fortification_status3, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort3Storetype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentFort3Storetype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentFort3Storetype = round(ReportCount2 / sum(ReportCount2)*100, 3)) 

write.xlsx(ReportsumProdVol_FoodFort3Storetype, file = "ReportsumProdVol_FoodFort3Storetype.xlsx",
           sheetName = "FoodFort3Storetype", append = FALSE)

#Reportsum and ProductVolume by food, Store type and product fortification status4
ReportsumProdVolByFoodStoretypeFort4 <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>% 
  dplyr::group_by(food, store_type, product_fortification_status4)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentStoretypeFort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentStoretypeFort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentStoretypeFort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodStoretypeFort4, file = "ReportsumProdVol_FoodStoretypeFort4.xlsx",
           sheetName = "FoodStoretypeFort4", append = FALSE)

#Reportsum and ProductVolume by food, product fortification status4 and Store type 
ReportsumProdVolByFoodFort4Storetype <- Datasubset_ReportsumProdVol_FoodStoretypeProduct %>%
  dplyr::group_by(food, product_fortification_status4, store_type)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort4Storetype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort4Storetype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort4Storetype = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort4Storetype, file = "ReportsumProdVol_FoodFort4Storetype.xlsx",
           sheetName = "FoodFort4Storetype", append = FALSE)


#Tables by FOOD,  REGION and BRANDPRODUCT Subcategories (food_type, origin, product_avg_price, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content)

#DATASUBSET  LEVEL 2: to generate Reportsum and ProductVolume and ProductCount by food, region and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
Datasubset_ReportsumProdVolByFoodRegionProduct <- datasubset %>% 
  #dplyr::group_by(food,region, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
  ##dplyr::mutate(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)%>%
  #dplyr::summarise(VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE))
  dplyr::group_by(food,region,origin, food_type,BrandProduct, product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, ShopVolAvgCorrected,product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
  dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)

write.xlsx(Datasubset_ReportsumProdVolByFoodRegionProduct, file = "Datasubset_ReportsumProdVolByFoodRegionProduct.xlsx",
           sheetName = "RegionProduct", append = FALSE)

#ShopCount by food and region
ShopCount_FoodRegion <- datasubset %>%
  dplyr::group_by(food, region)%>%
  dplyr::summarise(ReportCount = n_distinct(report_ID)) %>%
  dplyr::mutate(ShopPercentFoodRegion = round(ReportCount / sum(ReportCount)*100, 2))

  write.xlsx(ShopCount_FoodRegion, file = "ShopCount_FoodRegion.xlsx",
           sheetName = "ShopRegion", append = FALSE)

#Reportsum and ProductVolume by food and region
ReportsumProdVol_FoodRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))

  ReportsumProdVol_FoodRegion <- left_join(ReportsumProdVol_FoodRegion, ShopCount_FoodRegion,by =c("food","region")) 


write.xlsx(ReportsumProdVol_FoodRegion, file = "ReportsumProdVol_Region.xlsx",
           sheetName = "FoodRegion", append = FALSE)



#Reportsum and ProductVolume by food, region and food type
ReportsumProdVol_FoodRegionType <- Datasubset_ReportsumProdVolByFoodRegionProduct %>% 
  dplyr::group_by(food, region, food_type)%>% 
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionType = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodRegionType, file = "ReportsumProdVol_RegionType.xlsx",
           sheetName = "FoodRegionType", append = FALSE)

#Reportsum and ProductVolume by food, food type and region
ReportsumProdVol_FoodTypeRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, food_type, region)%>%
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentTypeRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentTypeRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentTypeRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))  

write.xlsx(ReportsumProdVol_FoodTypeRegion, file = "ReportsumProdVol_TypeRegion.xlsx",
           sheetName = "FoodRegionType", append = FALSE)

#Reportsum and ProductVolume by food, region and origin
ReportsumProdVolByFoodRegionOrigin <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, origin)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionOrigin = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
  dplyr::mutate(ProductPercentRegionOrigin = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
  dplyr::mutate(ReportPercentRegionOrigin = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionOrigin, file = "ReportsumProdVol_RegionOrigin.xlsx",
           sheetName = "FoodRegionOrigin", append = FALSE)

#Reportsum and ProductVolume by food, origin and region 
ReportsumProdVolByFoodOriginRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>% 
  dplyr::group_by(food, origin, region)%>% 
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentOriginRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentOriginRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentOriginRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodOriginRegion, file = "ReportsumProdVol_OriginRegion.xlsx",
           sheetName = "FoodOriginRegion", append = FALSE)

#Reportsum and ProductVolume by food, region and labelnutrient
ReportsumProdVolByFoodRegionLabelnutrient <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_labelnutrient)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionLabelnutr = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionLabelnutr = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionLabelnutr = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionLabelnutrient, file = "ReportsumProdVol_RegionLabelnutr.xlsx",
           sheetName = "FoodRegionLabelnutr", append = FALSE)

#Reportsum and ProductVolume by food, labelnutrient and region  
ReportsumProdVolByFoodLabelnutrientRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_labelnutrient, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelnutrRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentLabelnutrRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentLabelnutrRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodLabelnutrientRegion, file = "ReportsumProdVol_LabelnutrRegion.xlsx",
           sheetName = "FoodLabelnutrRegion", append = FALSE)

#Reportsum and ProductVolume by food, region and labelling
ReportsumProdVolByFoodRegionLabelling <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_labelling)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionLabel = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionLabel = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionLabel = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionLabelling, file = "ReportsumProdVol_RegionLabelling.xlsx",
           sheetName = "FoodRegionLabel", append = FALSE)

#Reportsum and ProductVolume by food, labelling and region
ReportsumProdVolByFoodLabellingRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_labelling, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentLabelRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentLabelRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentLabelRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodLabellingRegion, file = "ReportsumProdVol_LabellingRegion.xlsx",
           sheetName = "FoodLabelRegion", append = FALSE)

#Reportsum and ProductVolume by food, region and fortification status
ReportsumProdVolByFoodRegionFort <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_status)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionFort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionFort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionFort = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionFort, file = "ReportsumProdVol_RegionFort.xlsx",
           sheetName = "FoodRegionFort", append = FALSE)

#Reportsum and ProductVolume by food, fortification status and region
ReportsumProdVolByFoodFortRegion <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_status, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFortRegion = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFortRegion = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFortRegion = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFortRegion, file = "ReportsumProdVol_FortRegion.xlsx",
           sheetName = "FoodFortRegion", append = FALSE)

#Reportsum and ProductVolume by food, region and fortification status2
ReportsumProdVolByFoodRegionFort2 <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_status2)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionFort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionFort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionFort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionFort2, file = "ReportsumProdVol_RegionFort2.xlsx",
           sheetName = "FoodRegionFort2", append = FALSE)

#Reportsum and ProductVolume by food, fortification status2 and region  
ReportsumProdVolByFoodFort2Region <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_status, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort2Region = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort2Region = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentort2Region = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort2Region, file = "ReportsumProdVol_Fort2Region.xlsx",
           sheetName = "FoodFort2Region", append = FALSE)

#Reportsum and ProductVolume by food, region and fortification status3
ReportsumProdVolByFoodRegionFort3 <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_status3)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionFort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionFort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionFort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionFort2, file = "ReportsumProdVol_RegionFort2.xlsx",
           sheetName = "FoodRegionFort2", append = FALSE)

#Reportsum and ProductVolume by food, fortification status3 and region  
ReportsumProdVolByFoodFort3Region <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_status3, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort3Region = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort3Region = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort3Region = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort3Region, file = "ReportsumProdVol_Fort3Region.xlsx",
           sheetName = "FoodFort3Region", append = FALSE)

#Reportsum and ProductVolume by food, region and fortification status4
ReportsumProdVolByFoodRegionFort4 <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, region, product_fortification_status4)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentRegionFort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentRegionFort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentRegionFort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodRegionFort4, file = "ReportsumProdVol_RegionFort4.xlsx",
           sheetName = "FoodRegionFort4", append = FALSE)

#Reportsum and ProductVolume by food, fortification status4 and region  
ReportsumProdVolByFoodFort4Region <- Datasubset_ReportsumProdVolByFoodRegionProduct %>%
  dplyr::group_by(food, product_fortification_status4, region)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentFort4Region = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentFort4Region = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentFort4Region = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVolByFoodFort4Region, file = "ReportsumProdVol_Fort4Region.xlsx",
           sheetName = "FoodFort4Region", append = FALSE)



#Tables by FOOD,  ZONE7 and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET  LEVEL 2: to generate Reportsum and ProductVolume and ProductCount by food, zone7 and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
# Datasubset_ReportsumProdVolByFoodZone7Product <- datasubset %>%
#   #dplyr::group_by(food,zone7, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
#   #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
#   dplyr::group_by(food,zone7,origin, food_type,BrandProduct, product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, ShopVolAvgCorrected,product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
#   dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
# 
# write.xlsx(Datasubset_ReportsumProdVolByFoodZone7Product, file = "Datasubset_ReportsumProdVolByFoodZone7Product.xlsx",
#            sheetName = "Zone7Product", append = FALSE)


# 
# #ShopCount by food and zone7
# ShopCount_FoodZone7 <- datasubset %>%
#   dplyr::group_by(food, zone7)%>%
#   dplyr::summarise(ReportCount = n_distinct(report_ID))%>%
#   dplyr::mutate(ShopPercentFoodZone7 = round(ReportCount / sum(ReportCount)*100, 2))
# 
# write.xlsx(ShopCount_FoodZone7, file = "ShopCount_FoodZone7.xlsx",
#            sheetName = "ShopZone7", append = FALSE)
# 
# #Reportsum and ProductVolume by food and zone7
# ReportsumProdVolByFoodZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>%
#   dplyr::group_by(food, zone7)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3)) 
# 
# ReportsumProdVolByFoodZone7 <- left_join(ReportsumProdVolByFoodZone7, ShopCount_FoodZone7,by =c("food","zone7")) 
# 
# write.xlsx(ReportsumProdVolByFoodZone7, file = "ReportsumProdVol_Zone7.xlsx",
#            sheetName = "FoodZone7", append = FALSE)



#Reportsum and ProductVolume by food, zone7 and food type
# ReportsumProdVolByFoodZone7Type <- Datasubset_ReportsumProdVolByFoodZone7Product %>%
#   dplyr::group_by(food, zone7, food_type)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Type = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone7Type = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone7Type = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone7Type, file = "ReportsumProdVol_Zone7Type.xlsx",
#            sheetName = "FoodZone7Type", append = FALSE)

#Reportsum and ProductVolume by food, food type and zone7 
# ReportsumProdVolByFoodTypeZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, food_type, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentTypeZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentTypeZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentTypeZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))  
# 
# write.xlsx(ReportsumProdVolByFoodTypeZone7, file = "ReportsumProdVol_TypeZone7.xlsx",
#            sheetName = "FoodTypeZone7", append = FALSE)

#Reportsum and ProductVolume by food, zone7 and origin
# ReportsumProdVol_FoodZone7Origin <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, origin)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Origin = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Origin = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Origin = round(ReportCount2 / sum(ReportCount2)*100, 3))  
# 
# write.xlsx(ReportsumProdVol_FoodZone7Origin, file = "ReportsumProdVol_FoodZone7Origin.xlsx",
#            sheetName = "FoodZone7Origin", append = FALSE) 

#Reportsum and ProductVolume by food, origin and Zone7 
# ReportsumProdVol_FoodOriginZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, origin, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentOriginZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentOriginZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentOriginZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))  
# 
# write.xlsx(ReportsumProdVol_FoodOriginZone7, file = "ReportsumProdVol_FoodOriginZone7.xlsx",
#            sheetName = "FoodOriginZone7", append = FALSE)

#Reportsum and ProductVolume by food, zone7 and labelnutrient
# ReportsumProdVolByFoodZone7Labelnutrient <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_labelnutrient)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Labelnutr = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Labelnutr = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Labelnutr = round(ReportCount2 / sum(ReportCount2)*100, 3))  
# 
# write.xlsx(ReportsumProdVolByFoodZone7Labelnutrient, file = "ReportsumProdVol_Zone7Labelnutr.xlsx",
#            sheetName = "FoodZone7Labelnutr", append = FALSE)

#Reportsum and ProductVolume by food, labelnutrient and Zone7  
# ReportsumProdVolByFoodLabelnutrientZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, product_fortification_labelnutrient, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentLabelnutrZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentLabelnutrZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentLabelnutrZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodLabelnutrientZone7, file = "ReportsumProdVol_LabelnutrZone7.xlsx",
#            sheetName = "FoodLabelnutrZone7", append = FALSE)

#Reportsum and ProductVolume by food, Zone7 and labelling
# ReportsumProdVolByFoodZone7Labelling <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_labelling)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Labelling = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Labelling = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Labelling = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone7Labelling, file = "ReportsumProdVol_Zone7Label.xlsx",
#            sheetName = "FoodZone7Label", append = FALSE)

#Reportsum and ProductVolume by food, labelling and Zone7  
# ReportsumProdVolByFoodLabellingZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, product_fortification_labelling, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentLabelZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentLabelZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentRLabelZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodLabellingZone7, file = "ReportsumProdVol_LabelZone7.xlsx",
#            sheetName = "FoodLabelZone7", append = FALSE)

#Reportsum and ProductVolume by food, zone7 and fortification status
# ReportsumProdVolByFoodZone7Fort <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_status)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Fort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Fort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Fort = round(ReportCount2 / sum(ReportCount2)*100, 3)) 
# 
# write.xlsx(ReportsumProdVolByFoodZone7Fort, file = "ReportsumProdVol_Zone7Fort.xlsx",
#            sheetName = "FoodZone7Fort", append = FALSE)

#Reportsum and ProductVolume by food, fortification status and Zone7  
# ReportsumProdVolByFoodFortZone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, product_fortification_status, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFortZone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentFortZone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentFortZone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFortZone7, file = "ReportsumProdVol_FortZone7.xlsx",
#            sheetName = "FoodFortZone7", append = FALSE)

#Reportsum and ProductVolume by food, Zone7 and fortification status2
# ReportsumProdVolByFoodZone7Fort2 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_status2)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Fort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Fort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Fort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone7Fort2, file = "ReportsumProdVol_Zone7Fort2.xlsx",
#            sheetName = "FoodZone7Fort2", append = FALSE)

#Reportsum and ProductVolume by food, fortification status2 and Zone7  
# ReportsumProdVolByFoodFort2Zone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, product_fortification_status2, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort2Zone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentFort2Zone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentFort2Zone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort2Zone7, file = "ReportsumProdVolFort2Zone7.xlsx",
#            sheetName = "FoodFort2Zone7", append = FALSE)

#Reportsum and ProductVolume by food, Zone7 and fortification status3
# ReportsumProdVolByFoodZone7Fort3 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_status3)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Fort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone7Fort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone7Fort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone7Fort3, file = "ReportsumProdVol_Zone7Fort3.xlsx",
#            sheetName = "FoodZone7Fort3", append = FALSE)

#Reportsum and ProductVolume by food, fortification status3 and Zone7  
# ReportsumProdVolByFoodFort3Zone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, product_fortification_status3, zone7)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort3Zone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentFort3Zone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentFort3Zone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort3Zone7, file = "ReportsumProdVol_Fort3Zone7.xlsx",
#            sheetName = "FoodFort3Zone7", append = FALSE)

#Reportsum and ProductVolume by food, Zone7 and fortification status4
# ReportsumProdVolByFoodZone7Fort4 <- Datasubset_ReportsumProdVolByFoodZone7Product %>% 
#   dplyr::group_by(food, zone7, product_fortification_status4)%>% 
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone7Fort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone7Fort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone7Fort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone7Fort4, file = "ReportsumProdVol_Zone7Fort4.xlsx",
#            sheetName = "FoodZone7Fort4", append = FALSE)

#Reportsum and ProductVolume by food, fortification status4 and Zone7  
# ReportsumProdVolByFoodFort4Zone7 <- Datasubset_ReportsumProdVolByFoodZone7Product %>%
#   dplyr::group_by(food, product_fortification_status4, zone7)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort4Zone7 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentFort4Zone7 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentFort4Zone7 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort4Zone7, file = "ReportsumProdVol_Fort4Zone7.xlsx",
#            sheetName = "FoodFort4Zone7", append = FALSE)
# 


#Tables by FOOD,  ZONE6 and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET  LEVEL 2: to generate Reportsum and ProductVolume and ProductCount by food, zone6 and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
# Datasubset_ReportsumProdVolByFoodZone6Product <- datasubset %>%
#   #dplyr::group_by(food,zone6, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
#   #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank))%>% 
#   #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
#   dplyr::group_by(food,zone6,origin, origin_large, food_type,BrandProduct, ShopVolAvgCorrected,product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
#   dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
# 
# write.xlsx(Datasubset_ReportsumProdVolByFoodZone6Product, file = "Datasubset_ReportsumProdVolByFoodZone6Product.xlsx",
#            sheetName = "Zone6Product", append = FALSE)


#ShopCount by food and zone6 
# ShopCount_FoodZone6 <- datasubset %>%
#   dplyr::group_by(food, zone6)%>%
#   dplyr::summarise(ReportCount = n_distinct(report_ID))%>%
#   dplyr::mutate(ShopPercentFoodZone6 = round(ReportCount / sum(ReportCount)*100, 2))
# 
# write.xlsx(ShopCount_FoodZone6, file = "ShopCount_FoodZone6.xlsx",
#            sheetName = "ShopZone6", append = FALSE)

#Reportsum and ProductVolume by food and zone6
# ReportsumProdVolByFoodZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# ReportsumProdVolByFoodZone6 <- left_join(ReportsumProdVolByFoodZone6, ShopCount_FoodZone6,by =c("food","zone6"))
# 
# write.xlsx(ReportsumProdVolByFoodZone6, file = "ReportsumProdVol_Zone6.xlsx",
#            sheetName = "FoodZone6", append = FALSE)



#Reportsum and ProductVolume by food, zone6 and food type
# ReportsumProdVolByFoodZone6Type <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, food_type)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Type = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Type = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Type = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Type, file = "ReportsumProdVol_Zone6Type.xlsx",
#            sheetName = "FoodZone6Type", append = FALSE)

#Reportsum and ProductVolume by food, food type and zone6 
# ReportsumProdVolByFoodTypeZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, food_type, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentTypeZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentTypeZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentTypeZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodTypeZone6, file = "ReportsumProdVol_TypeZone6.xlsx",
#            sheetName = "FoodTypeZone6", append = FALSE)

#Reportsum and ProductVolume by food, zone6 and origin
# ReportsumProdVolByFoodZone6Origin <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, origin)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Origin = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Origin = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Origin = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Origin, file = "ReportsumProdVol_Zone6Origin.xlsx",
#            sheetName = "FoodZone6Origin", append = FALSE)  

#Reportsum and ProductVolume by food, origin and Zone6
# ReportsumProdVolByFoodOriginZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, origin, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentOriginZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentOriginZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentOriginZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodOriginZone6, file = "ReportsumProdVol_OriginZone6.xlsx",
#            sheetName = "FoodOriginZone6", append = FALSE)



#Reportsum and ProductVolume by food, zone6 and originlarge
# ReportsumProdVolByFoodZone6Originlarge <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, origin_large)%>%
#   dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Originlarge = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>% 
#   dplyr::mutate(ProductPercentZone6Originlarge = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>% 
#   dplyr::mutate(ReportPercentZone6Originlarge = round(ReportCount2 / sum(ReportCount2)*100, 3))  
# 
# write.xlsx(ReportsumProdVolByFoodZone6Originlarge, file = "ReportsumProdVol_Zone6Originlarge.xlsx",
#            sheetName = "FoodZone6Originlarge", append = FALSE)

#Reportsum and ProductVolume by food, originlarge and Zone6
# ReportsumProdVolByFoodOriginlargeZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, origin_large, zone6)%>%
#   dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentOriginlargeZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentOriginlargeZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentOriginlargeZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodOriginlargeZone6, file = "ReportsumProdVol_OriginlargeZone6.xlsx",
#            sheetName = "FoodOriginlargeZone6", append = FALSE)

#Filter only large
#Reportsum and ProductVolume by food, originlarge and zone6
# ReportsumProdVol_FoodZone6FilterOriginLarge <- Datasubset_ReportsumProdVolByFoodZone6Product %>% 
#   dplyr::filter(origin_large =="Import large"|origin_large =="Local large")%>%
#   dplyr::group_by(food, zone6)%>%
#   dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Originlarge = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Originlarge = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Originlarge = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVol_FoodZone6FilterOriginLarge, file = "FoodZone6FilterOriginLarge.xlsx",
#            sheetName = "FoodZone6Originlarge", append = FALSE)

#Reportsum and ProductVolume by food, zone6 and labelnutrient
# ReportsumProdVolByFoodZone6Labelnutrient <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_labelnutrient)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Labelnutrient = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Labelnutrient = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Labelnutrient = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Labelnutrient, file = "ReportsumProdVol_Zone6Labelnutr.xlsx",
#            sheetName = "FoodZone6Labelnutr", append = FALSE)

#Reportsum and ProductVolume by food, labelnutrient and Zone6  
# ReportsumProdVolByFoodLabelnutrientZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_labelnutrient, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentLabelnutrZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentLabelnutrZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentLabelnutrZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodLabelnutrientZone6, file = "ReportsumProdVol_LabelnutrZone6.xlsx",
#            sheetName = "FoodLabelnutrZone6", append = FALSE)

#Reportsum and ProductVolume by food, Zone6 and labelling
# ReportsumProdVolByFoodZone6Labelling <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_labelling)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Label = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Label = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Label = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Labelling, file = "ReportsumProdVol_Zone6Label.xlsx",
#            sheetName = "FoodZone6Label", append = FALSE)

#Reportsum and ProductVolume by food, labelling and Zone6  
# ReportsumProdVolByFoodLabellingZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_labelling, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentLabelZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentLabelZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentRLabelZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodLabellingZone6, file = "ReportsumProdVol_LabelZone6.xlsx",
#            sheetName = "FoodLabelZone6", append = FALSE)

#Reportsum and ProductVolume by food, zone6 and fortification status
# ReportsumProdVolByFoodZone6Fort <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_status)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Fort = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Fort = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Fort = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Fort, file = "ReportsumProdVol_Zone6Fort.xlsx",
#            sheetName = "FoodZone6Fort", append = FALSE)

#Reportsum and ProductVolume by food, fortification status and Zone6  
# ReportsumProdVolByFoodFortZone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_status, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFortZone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentFortZone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentFortZone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFortZone6, file = "ReportsumProdVol_FortZone6.xlsx",
#            sheetName = "FoodFortZone6", append = FALSE)

#Reportsum and ProductVolume by food, zone6 and fortification status2
# ReportsumProdVolByFoodZone6Fort2 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_status2)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Fort2 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Fort2 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Fort2 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Fort2, file = "ReportsumProdVol_Zone6Fort2.xlsx",
#            sheetName = "FoodZone6Fort2", append = FALSE)

#Reportsum and ProductVolume by food, fortification status2 and Zone6  
# ReportsumProdVolByFoodFort2Zone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_status, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort2Zone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentFort2Zone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentFort2Zone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort2Zone6, file = "ReportsumProdVolFort2Zone6.xlsx",
#            sheetName = "FoodFort2Zone6", append = FALSE)

#Reportsum and ProductVolume by food, zone6 and fortification status3
# ReportsumProdVolByFoodZone6Fort3 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_status3)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Fort3 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Fort3 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Fort3 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Fort3, file = "ReportsumProdVol_Zone6Fort3.xlsx",
#            sheetName = "FoodZone6Fort3", append = FALSE)

#Reportsum and ProductVolume by food, fortification status3 and Zone6
# ReportsumProdVolByFoodFort3Zone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_status3, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort3Zone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentFort3Zone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentFort3Zone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort3Zone6, file = "ReportsumProdVol_Fort3Zone6.xlsx",
#            sheetName = "FoodFort3Zone6", append = FALSE)

#Reportsum and ProductVolume by food, Zone6 and fortification status4
# ReportsumProdVolByFoodZone6Fort4 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, zone6, product_fortification_status4)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Fort4 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Fort4 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Fort4 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodZone6Fort4, file = "ReportsumProdVol_Zone6Fort4.xlsx",
#            sheetName = "FoodZone6Fort4", append = FALSE)

#Reportsum and ProductVolume by food, fortification status4 and Zone6
# ReportsumProdVolByFoodFort4Zone6 <- Datasubset_ReportsumProdVolByFoodZone6Product %>%
#   dplyr::group_by(food, product_fortification_status4, zone6)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentFort4Zone6 = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentFort4Zone6 = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentFort4Zone6 = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
# write.xlsx(ReportsumProdVolByFoodFort4Zone6, file = "ReportsumProdVol_Fort4Zone6.xlsx",
#            sheetName = "FoodFort4Zone6", append = FALSE)
# 



#DATASUBSET  LEVEL 3 for Sankey charts: to generate Reportsum and ProductVolume and ProductCount by food, zone6 and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
# Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct <- datasubset %>%
#   #dplyr::group_by(food,zone6, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
#   #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank))%>% 
#   #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
#   dplyr::group_by(food,zone6,origin, store_type, food_type,BrandProduct, ShopVolAvgCorrected,product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
#   dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
# 
# write.xlsx(Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct, file = "Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct.xlsx",
#            sheetName = "Zone6StoreProd", append = FALSE)

#Tables by FOOD,  ZONE6, Store_type and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 


#Table by FOOD with nodes ZONE6, Store_type and flow value Product volume 
#Table by FOOD with nodes ZONE6, Store_type and flow value Product count 
#Table by FOOD with nodes ZONE6, Store_type and flow value Report count 

# ShopCount_FoodZone6Storetype <- datasubset %>%
#   dplyr::group_by(food,zone6, store_type)%>%
#   dplyr::summarise(ReportCount = n_distinct(report_ID))%>%
#   dplyr::mutate(ShopPercentZone6Storetype = round(ReportCount / sum(ReportCount)*100, 2))
# 
# ReportsumProdVolByFoodZone6Storetype <- Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct %>%
#   dplyr::group_by(food,zone6, store_type)%>%
#     dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
#                    VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
#                    Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
#                    Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
#                    Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
#                    product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
#                    product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
#                    VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
#                    Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
#   )%>%
#   dplyr::mutate(ProdVolPercentZone6Storetype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
#   dplyr::mutate(ProductPercentZone6Storetype = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
#   dplyr::mutate(ReportPercentZone6Storetype = round(ReportCount2 / sum(ReportCount2)*100, 3))
# 
#   ReportsumProdVolByFoodZone6Storetype <- left_join(ReportsumProdVolByFoodZone6Storetype, ShopCount_FoodZone6Storetype,by =c("food","zone6","store_type"))
# 
#   write.xlsx(ReportsumProdVolByFoodZone6Storetype, file = "ReportsumProdVol_FoodZone6Storetype.xlsx",
#            sheetName = "Zone6Store", append = FALSE)


#Table by FOOD with nodes ZONE6, BrandProduct, Store_type and flow value Product volume 
#Table by FOOD with nodes ZONE6, BrandProduct, Store_type and flow value Product count 
#Table by FOOD with nodes ZONE6, BrandProduct, Store_type and flow value Report count 


#Table by FOOD with nodes Food_type, ZONE6, Store_type and flow value Product volume
#Table by FOOD with nodes Food_type, ZONE6, Store_type and flow value Product count
#Table by FOOD with nodes Food_type, ZONE6, Store_type and flow value Report count

# ReportSumProdVolByFoodFoodTypeZone6Storetype <- Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct %>%
#   dplyr::group_by(food, food_type, zone6, store_type)%>%
#   dplyr::summarise(ReportCountSum = sum(ReportCount), ProductVolumeShopSum = sum(ProductVolumeShop), ProductCountSum = sum(ProductCount))
# 
# write.xlsx(ReportSumProdVolByFoodFoodTypeZone6Storetype, file = "ReportSumProdVolByFoodFoodTypeZone6Storetype.xlsx",
#            sheetName = "TypeZone6Store", append = FALSE)


#Table by FOOD with nodes origin, ZONE6, Store_type and flow value Product volume 
#Table by FOOD with nodes origin, ZONE6, Store_type and flow value Product count 
#Table by FOOD with nodes origin, ZONE6, Store_type and flow value Report count  

# ReportSumProdVolByFoodOriginZone6Storetype <- Datasubset_ReportsumProdVolByFoodZone6StoretypeProduct %>%
#   dplyr::group_by(food, origin, zone6, store_type)%>%
#   dplyr::summarise(ReportCountSum = sum(ReportCount), ProductVolumeShopSum = sum(ProductVolumeShop), ProductCountSum = sum(ProductCount))
# 
# write.xlsx(ReportSumProdVolByFoodOriginZone6Storetype, file = "ReportSumProdVolByFoodOriginZone6Storetype.xlsx",
#            sheetName = "OriginZone6Store", append = FALSE)


#Tables by FOOD,  ZONE7, Store_type and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET  LEVEL 3 for Sankey charts: to generate Reportsum and ProductVolume and ProductCount by food, zone7 and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
# Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct <- datasubset %>%
#   #dplyr::group_by(food,zone7, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
#   #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank))%>% 
#   #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
#   dplyr::group_by(food,zone7,origin, store_type, food_type,BrandProduct, ShopVolAvgCorrected,product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank ,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,  Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
#   dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
# 
# write.xlsx(Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct, file = "Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct.xlsx",
#            sheetName = "Zone7StoreProd", append = FALSE)

 

#Table by FOOD with nodes ZONE7, Store_type and flow value Product volume 
#Table by FOOD with nodes ZONE7, Store_type and flow value Product count 
#Table by FOOD with nodes ZONE7, Store_type and flow value Report count

#ShopCount by food, zone7 and store_type
# ShopCount_FoodZone7Storetype <- datasubset %>%
#   dplyr::group_by(food, zone7, store_type)%>%
#   dplyr::summarise(ReportCount = n_distinct(report_ID))%>%
# dplyr::mutate(ShopPercentZone7Storetype = round(ReportCount / sum(ReportCount)*100, 2))
# 
# ReportsumProdVolByFoodZone7Storetype <- Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct %>%
#   dplyr::group_by(food,zone7, store_type)%>%
#   dplyr::summarise(ReportCount2 = sum(ReportCount), ProductVolumeShopSum = sum(ProductVolumeShop), ProductCountSum = sum(ProductCount))%>%
#   dplyr::mutate(ProdVolPercentZone7Storetype = round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 2)) %>%
#   dplyr::mutate(ProductPercentZone7Storetype = round(ProductCountSum / sum(ProductCountSum)*100, 2)) %>%
#   dplyr::mutate(ReportPercentZone7Storetype = round(ReportCount2 / sum(ReportCount2)*100, 2))
# 
#   ReportsumProdVolByFoodZone7Storetype <- left_join(ReportsumProdVolByFoodZone7Storetype, ShopCount_FoodZone7Storetype,by =c("food","zone7","store_type")) 
# 
# write.xlsx(ReportsumProdVolByFoodZone7Storetype, file = "ReportsumProdVol_FoodZone7Storetype.xlsx",
#            sheetName = "Zone7Storetype", append = FALSE)


#ShopCount by food, zone6 and store_type
# ShopCount_FoodZone6Storetype <- datasubset %>%
#   dplyr::group_by(food, zone6, store_type)%>%
#   dplyr::summarise(ReportCount = n_distinct(report_ID))
# 
# write.xlsx(ShopCount_FoodZone6Storetype, file = "ShopCount_FoodZone6Storetype.xlsx",
#            sheetName = "ShopZone6Storetype", append = FALSE)

#Table by FOOD with nodes Food_type, ZONE7, Store_type and flow value Product volume 
#Table by FOOD with nodes Food_type, ZONE7, Store_type and flow value Product count 
#Table by FOOD with nodes Food_type, ZONE7, Store_type and flow value Report count 
# 
# ReportSumProdVolByFoodFoodTypeZone7Storetype <- Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct %>%
#   dplyr::group_by(food, food_type, zone7, store_type)%>%
#   dplyr::summarise(ReportCount2 = sum(ReportCount), ProductVolumeShopSum = sum(ProductVolumeShop), ProductCountSum = sum(ProductCount))
# 
# write.xlsx(ReportSumProdVolByFoodFoodTypeZone7Storetype, file = "ReportSumProdVolByFoodFoodTypeZone7Storetype.xlsx",
#            sheetName = "TypeZone7Store", append = FALSE)


#Table by FOOD with nodes origin, ZONE7, Store_type and flow value Product volume 
#Table by FOOD with nodes origin, ZONE7, Store_type and flow value Product count 
#Table by FOOD with nodes origin, ZONE7, Store_type and flow value Report count  

# ReportSumProdVolByFoodOriginZone7Storetype <- Datasubset_ReportsumProdVolByFoodZone7StoretypeProduct %>%
#   dplyr::group_by(food, origin, zone7, store_type)%>%
#   dplyr::summarise(ReportCountSum = sum(ReportCount), ProductVolumeShopSum = sum(ProductVolumeShop), ProductCountSum = sum(ProductCount))
# 
# write.xlsx(ReportSumProdVolByFoodOriginZone7Storetype, file = "ReportSumProdVolByFoodOriginZone7Storetype.xlsx",
#            sheetName = "OriginZone7Store", append = FALSE)


#Tables by FOOD,  region, Store_type and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET  LEVEL 3 for Sankey charts: to generate Reportsum and ProductVolume and ProductCount by food, zone6 and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
Datasubset_ReportsumProdVolByFoodRegionStoretypeProduct <- datasubset %>%
  #dplyr::group_by(food,region, origin, food_type,product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
  #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank))%>% 
  #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
  dplyr::group_by(food,region,origin, store_type, food_type,BrandProduct, ShopVolAvgCorrected,product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
  dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)

write.xlsx(Datasubset_ReportsumProdVolByFoodRegionStoretypeProduct, file = "Datasubset_ReportsumProdVolByFoodRegionStoretypeProduct.xlsx",
           sheetName = "RegionStoreProd", append = FALSE)

#Table by FOOD with nodes REGION, Store_type and flow value Product volume 
#Table by FOOD with nodes REGION, Store_type and flow value Product count 
#Table by FOOD with nodes REGION, Store_type and flow value Report count 

#Table by FOOD with nodes REGION, BrandProduct, Store_type and flow value Product volume 
#Table by FOOD with nodes REGION, BrandProduct, Store_type and flow value Product count 
#Table by FOOD with nodes REGION, BrandProduct, Store_type and flow value Report count 

#Table by FOOD with nodes Food_type, REGION, Store_type and flow value Product volume 
#Table by FOOD with nodes Food_type, REGION, Store_type and flow value Product count 
#Table by FOOD with nodes Food_type, REGION, Store_type and flow value Report count 

#Table by FOOD with nodes origin, REGION, Store_type and flow value Product volume 
#Table by FOOD with nodes origin, REGION, Store_type and flow value Product count 
#Table by FOOD with nodes origin, REGION, Store_type and flow value Report count  




#Tables by FOOD,  zone7, Store_type, selected_supplier_by_supplier_name and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET  LEVEL 3 for Sankey charts: to generate Reportsum and ProductVolume and ProductCount by food, zone and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
# Datasubset_ReportsumProdVolByFoodZone7StoretypeSupplierProduct <- datasubset %>%
#   #dplyr::group_by(food,zone7, origin, food_type,selected_supplier_by_supplier_name, product_fortification_labelnutrient, product_fortification_status, product_fortification_status2, product_fortification_status3, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank,Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank, BrandProduct)%>% 
#   #dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct),VitA_product_avg_min_pos_or_blank=mean(VitA_product_avg_min_pos_or_blank), VitA_product_avg_max_pos_or_blank=mean(VitA_product_avg_max_pos_or_blank), VitA_product_avg_pos_or_blank=mean(VitA_product_avg_pos_or_blank), VitA_product_MU_avg_pos_or_blank=mean(VitA_product_MU_avg_pos_or_blank),	VitA_product_MU_max_pos_or_blank=mean(VitA_product_MU_max_pos_or_blank), Iron_product_avg_min_pos_or_blank=mean(Iron_product_avg_min_pos_or_blank), Iron_product_avg_max_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_avg_pos_or_blank=mean(Iron_product_avg_max_pos_or_blank), Iron_product_MU_avg_pos_or_blank=mean(Iron_product_MU_avg_pos_or_blank),	Iron_product_MU_max_pos_or_blank=mean(Iron_product_MU_max_pos_or_blank), Zinc_product_avg_min_pos_or_blank=mean(Zinc_product_avg_min_pos_or_blank), Zinc_product_avg_max_pos_or_blank=mean(Zinc_product_avg_max_pos_or_blank), Zinc_product_avg_pos_or_blank=mean(Zinc_product_avg_pos_or_blank), Zinc_product_MU_avg_pos_or_blank=mean(Zinc_product_MU_avg_pos_or_blank),	Zinc_product_MU_max_pos_or_blank=mean(Zinc_product_MU_max_pos_or_blank),Iodine_product_avg_min_pos_or_blank=mean(Iodine_product_avg_min_pos_or_blank), Iodine_product_avg_max_pos_or_blank=mean(Iodine_product_avg_max_pos_or_blank), Iodine_product_avg_pos_or_blank=mean(Iodine_product_avg_pos_or_blank), Iodine_product_MU_avg_pos_or_blank=mean(Iodine_product_MU_avg_pos_or_blank),	Iodine_product_MU_max_pos_or_blank=mean(Iodine_product_MU_max_pos_or_blank))%>% 
#   #dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
#   dplyr::group_by(food,zone7,origin, store_type, food_type,selected_supplier_by_supplier_name, selected_supplier_country, BrandProduct, ShopVolAvgCorrected,product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank, Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
#   dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
#   dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)
# 
# write.xlsx(Datasubset_ReportsumProdVolByFoodZone7StoretypeSupplierProduct, file = "Datasubset_ReportsumProdVolByFoodZone7StoretypeSupplierProduct.xlsx",
#            sheetName = "Zone7SuppStoreProd", append = FALSE)



#Tables by FOOD, SELECTED_SUPPLIER and BRANDPRODUCT Subcategories (food_type, origin, product avg_price_kg_l, product fortification labelnutrient, product fortification labelling, product fortification status (2-4), measurand avg content) 

#DATASUBSET LEVEL 1: to generate Reportsum and ProductVolume and ProductCount by food, selected_supplier and product(including indication of Origin, Foodtype, Label,FortStatus which is the same by product)
Datasubset_ReportsumProdVolByFoodSupplierProduct <- datasubset %>%
  #dplyr::group_by(food,origin, food_type,BrandProduct, ShopVolAvgCorrected,ProdVolCorrectedTotal, product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3)%>% 
  dplyr::group_by(food,origin, food_type,BrandProduct, selected_supplier_by_supplier_name, selected_supplier_country,  product_avg_price_kg_l, product_min_price_kg_l, product_max_price_kg_l, ShopVolAvgCorrected,product_fortification_logo,	product_fortification_statement,	product_fortification_nutrient,	product_fortification_labelling,product_fortification_labelnutrient, product_fortification_status,product_fortification_status2, product_fortification_status3, product_fortification_status4, VitA_standard_min_avg, VitA_standard_max_avg, VitA_product_avg_min_pos_or_blank, VitA_product_avg_max_pos_or_blank, VitA_product_avg_pos_or_blank, VitA_product_MU_avg_pos_or_blank,	VitA_product_MU_max_pos_or_blank,Iron_standard_min_avg, Iron_standard_max_avg, Iron_product_avg_min_pos_or_blank, Iron_product_avg_max_pos_or_blank, Iron_product_avg_pos_or_blank, Iron_product_MU_avg_pos_or_blank,	Iron_product_MU_max_pos_or_blank, Zinc_standard_min_avg, Zinc_standard_max_avg, Zinc_product_avg_min_pos_or_blank, Zinc_product_avg_max_pos_or_blank, Zinc_product_avg_pos_or_blank, Zinc_product_MU_avg_pos_or_blank,	Zinc_product_MU_max_pos_or_blank, Iodine_standard_min_avg, Iodine_standard_max_avg, Iodine_product_avg_min_pos_or_blank, Iodine_product_avg_max_pos_or_blank, Iodine_product_avg_pos_or_blank, Iodine_product_MU_avg_pos_or_blank,	Iodine_product_MU_max_pos_or_blank)%>% 
  dplyr::summarise(ReportCount = n_distinct(report_ID), ShopVolAvgCorrected2 = mean(ShopVolAvgCorrected), ProductCount = n_distinct(BrandProduct))%>% 
  dplyr::mutate(ProductVolumeShop = ShopVolAvgCorrected2*ReportCount)

write.xlsx(Datasubset_ReportsumProdVolByFoodSupplierProduct, file = "Datasubset_ReportsumProdVolByFoodSupplierProduct.xlsx",
           sheetName = "Product", append = FALSE)


#Reportsum and ProductVolume by food, selected_supplier and product
ReportsumProdVol_FoodSupplierProduct <- Datasubset_ReportsumProdVolByFoodSupplierProduct %>%
  dplyr::group_by(food, selected_supplier_by_supplier_name, selected_supplier_country, BrandProduct)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentType= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodSupplierProduct, file = "ReportsumProdVol_FoodSupplierProduct.xlsx",
           sheetName = "FoodSupplier", append = FALSE)

#Reportsum and ProductVolume by food, product and selected_supplier
ReportsumProdVol_FoodProduct <- Datasubset_ReportsumProdVolByFoodSupplierProduct %>%
  dplyr::group_by(food)%>%
    dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercent= round(ProductVolumeShopSum / ProductVolumeShopSum*100, 3)) %>%
  dplyr::mutate(ProductPercent = round(ProductCount2 / ProductCount2*100, 3)) %>%
  dplyr::mutate(ReportPercent = round(ReportCount2 / ReportCount2*100, 3))

write.xlsx(ReportsumProdVol_FoodProduct, file = "ReportsumProdVol_FoodProduct.xlsx",
           sheetName = "FoodProduct", append = FALSE)

#Reportsum and ProductVolume by food, product and selected_supplier
ReportsumProdVol_FoodSupplier <- Datasubset_ReportsumProdVolByFoodSupplierProduct %>%
  dplyr::group_by(food)%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  dplyr::mutate(ProductVolumeShopSumFood=sum(ProductVolumeShop), ReportCount2Food=sum(ReportCount), ProductCount2Food=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount))%>%
  dplyr::mutate(ProdVolPercentProduct= round(ProductVolumeShop / ProductVolumeShopSumFood*100, 3)) %>%
  dplyr::mutate(ProductPercentProduct = round(ProductCount / ProductCount2Food*100, 3)) %>%
  dplyr::mutate(ReportPercentProduct = round(ReportCount / ReportCount2Food*100, 3))%>%
  dplyr::group_by(food, selected_supplier_by_supplier_name)%>%
  dplyr::mutate(ProductVolumeShopSumSupplier=sum(ProductVolumeShop), ReportCount2Supplier=sum(ReportCount), ProductCount2Supplier=sum(ProductCount))%>%
  dplyr::mutate(ProdVolPercentSupplier= round(ProductVolumeShopSumSupplier / ProductVolumeShopSumFood*100, 3)) %>%
  dplyr::mutate(ProductPercentSupplier = round(ProductCount2Supplier / ProductCount2Food*100, 3)) %>%
  dplyr::mutate(ReportPercentSupplier = round(ReportCount2Supplier / ReportCount2Food*100, 3))

write.xlsx(ReportsumProdVol_FoodSupplier, file = "ReportsumProdVol_FoodSupplier.xlsx",
           sheetName = "FoodSupplier", append = FALSE)


#Reportsum and ProductVolume by food, product and selected_supplier
ReportsumProdVol_FoodProductSupplier <- Datasubset_ReportsumProdVolByFoodSupplierProduct %>%
  dplyr::group_by(food, BrandProduct, selected_supplier_by_supplier_name, selected_supplier_country)%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount), product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE))%>%
  #dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount))%>% 
  dplyr::summarise(ProductVolumeShopSum=sum(ProductVolumeShop), ReportCount2=sum(ReportCount), ProductCount2=sum(ProductCount),
                   VitA_standard_min_avg=mean(VitA_standard_min_avg, na.rm = TRUE),VitA_standard_max_avg=mean(VitA_standard_max_avg, na.rm = TRUE),
                   Iron_standard_min_avg=mean(Iron_standard_min_avg, na.rm = TRUE),Iron_standard_max_avg=mean(Iron_standard_max_avg, na.rm = TRUE),
                   Zinc_standard_min_avg=mean(Zinc_standard_min_avg, na.rm = TRUE),Zinc_standard_max_avg=mean(Zinc_standard_max_avg, na.rm = TRUE),
                   Iodine_standard_min_avg=mean(Iodine_standard_min_avg, na.rm = TRUE),Iodine_standard_max_avg=mean(Iodine_standard_max_avg, na.rm = TRUE),
                   product_avg_price_kg_l_avg=mean(product_avg_price_kg_l, na.rm = TRUE), product_min_price_kg_l_avg=mean(product_min_price_kg_l, na.rm = TRUE), product_max_price_kg_l_avg=mean(product_max_price_kg_l, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_Total=mean(Iodine_product_avg_min_pos_or_blank,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_Total=mean(Iodine_product_avg_max_pos_or_blank,na.rm = TRUE),Iodine_product_avg_pos_or_blank_Total=mean(Iodine_product_avg_pos_or_blank,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalProdWeight=weighted.mean(product_avg_price_kg_l, ProductCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalProdWeight=weighted.mean(product_min_price_kg_l, ProductCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalProdWeight=weighted.mean(product_max_price_kg_l, ProductCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalProdWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalProdWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalProdWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductCount,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalVolWeight=weighted.mean(product_avg_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_min_price_kg_l_avg_TotalVolWeight=weighted.mean(product_min_price_kg_l, ProductVolumeShop, na.rm = TRUE), product_max_price_kg_l_avg_TotalVolWeight=weighted.mean(product_max_price_kg_l, ProductVolumeShop, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ProductVolumeShop,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(VitA_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalVolWeight= weighted.mean(Iron_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalVolWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE), VitA_product_avg_min_pos_or_blank_Total=mean(VitA_product_avg_min_pos_or_blank,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_Total=mean(VitA_product_avg_max_pos_or_blank,na.rm = TRUE),VitA_product_avg_pos_or_blank_Total=mean(VitA_product_avg_pos_or_blank,na.rm = TRUE),Iron_product_avg_min_pos_or_blank_Total=mean(Iron_product_avg_min_pos_or_blank,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_Total=mean(Iron_product_avg_max_pos_or_blank,na.rm = TRUE),Iron_product_avg_pos_or_blank_Total= mean(Iron_product_avg_pos_or_blank,na.rm = TRUE),Zinc_product_avg_min_pos_or_blank_Total= mean(Zinc_product_avg_min_pos_or_blank,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_Total=mean(Zinc_product_avg_max_pos_or_blank,na.rm = TRUE),Zinc_product_avg_pos_or_blank_Total=mean(Zinc_product_avg_pos_or_blank,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ProductVolumeShop,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalVolWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ProductVolumeShop,na.rm = TRUE),
                   product_avg_price_kg_l_avg_TotalRepWeight=weighted.mean(product_avg_price_kg_l, ReportCount, na.rm = TRUE), product_min_price_kg_l_avg_TotalRepWeight=weighted.mean(product_min_price_kg_l, ReportCount, na.rm = TRUE), product_max_price_kg_l_avg_TotalRepWeight=weighted.mean(product_max_price_kg_l, ReportCount, na.rm = TRUE),
                   VitA_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),VitA_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_max_pos_or_blank, ReportCount,na.rm = TRUE),VitA_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(VitA_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iron_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iron_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iron_product_avg_pos_or_blank_TotalRepWeight= weighted.mean(Iron_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Zinc_product_avg_min_pos_or_blank_TotalRepWeight= weighted.mean(Zinc_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Zinc_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Zinc_product_avg_pos_or_blank,ReportCount,na.rm = TRUE),
                   Iodine_product_avg_min_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_min_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_max_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_max_pos_or_blank,ReportCount,na.rm = TRUE),Iodine_product_avg_pos_or_blank_TotalRepWeight=weighted.mean(Iodine_product_avg_pos_or_blank,ReportCount,na.rm = TRUE)
  )%>%
  dplyr::mutate(ProdVolPercentType= round(ProductVolumeShopSum / sum(ProductVolumeShopSum)*100, 3)) %>%
  dplyr::mutate(ProductPercentType = round(ProductCount2 / sum(ProductCount2)*100, 3)) %>%
  dplyr::mutate(ReportPercentType = round(ReportCount2 / sum(ReportCount2)*100, 3))

write.xlsx(ReportsumProdVol_FoodProductSupplier, file = "ReportsumProdVol_FoodProductSupplier.xlsx",
           sheetName = "FoodProductSupplier", append = FALSE)